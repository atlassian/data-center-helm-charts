<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=../INSTALLATION/ rel=prev><link href=../MIGRATION/ rel=next><link rel=icon href=../../assets/logos/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.23"><title>Configuration - Atlassian DC Helm Charts</title><link rel=stylesheet href=../../assets/stylesheets/main.84d31ad4.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-FZ7HCVNVPY"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-FZ7HCVNVPY",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-FZ7HCVNVPY",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#configuration class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <a href=https://community.atlassian.com/t5/Atlassian-Data-Center-on/gh-p/DC_Kubernetes title="Share your feedback with the Atlassian Data Center on Kubernetes Community" style=color:white><strong>Share your feedback and join the discussion</strong></a> </div> </aside> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Atlassian DC Helm Charts" class="md-header__button md-logo" aria-label="Atlassian DC Helm Charts" data-md-component=logo> <img src=../../assets/logos/atlassian-logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Atlassian DC Helm Charts </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Configuration </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/atlassian/data-center-helm-charts title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> atlassian/data-center-helm-charts </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../PREREQUISITES/ class=md-tabs__link> User guide </a> </li> <li class=md-tabs__item> <a href=../../examples/EXAMPLES/ class=md-tabs__link> Examples </a> </li> <li class=md-tabs__item> <a href=../../troubleshooting/TROUBLESHOOTING/ class=md-tabs__link> Troubleshooting </a> </li> <li class=md-tabs__item> <a href=../../platforms/PLATFORMS/ class=md-tabs__link> Platforms </a> </li> <li class=md-tabs__item> <a href=../../containers/JIRA/ class=md-tabs__link> Containers </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Atlassian DC Helm Charts" class="md-nav__button md-logo" aria-label="Atlassian DC Helm Charts" data-md-component=logo> <img src=../../assets/logos/atlassian-logo.svg alt=logo> </a> Atlassian DC Helm Charts </label> <div class=md-nav__source> <a href=https://github.com/atlassian/data-center-helm-charts title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> atlassian/data-center-helm-charts </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> User guide </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> User guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../PREREQUISITES/ class=md-nav__link> <span class=md-ellipsis> Prerequisites </span> </a> </li> <li class=md-nav__item> <a href=../VERIFICATION/ class=md-nav__link> <span class=md-ellipsis> Verification </span> </a> </li> <li class=md-nav__item> <a href=../INSTALLATION/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Configuration </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Configuration </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#ingress class=md-nav__link> <span class=md-ellipsis> Ingress </span> </a> </li> <li class=md-nav__item> <a href=#session-stickiness-for-high-availability class=md-nav__link> <span class=md-ellipsis> Session Stickiness for High Availability </span> </a> <nav class=md-nav aria-label="Session Stickiness for High Availability"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nginx-ingress-controller class=md-nav__link> <span class=md-ellipsis> NGINX Ingress Controller </span> </a> <nav class=md-nav aria-label="NGINX Ingress Controller"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#custom-configuration class=md-nav__link> <span class=md-ellipsis> Custom Configuration </span> </a> </li> <li class=md-nav__item> <a href=#verify-configuration class=md-nav__link> <span class=md-ellipsis> Verify Configuration </span> </a> </li> <li class=md-nav__item> <a href=#common-issues class=md-nav__link> <span class=md-ellipsis> Common Issues </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#other-ingress-controllers class=md-nav__link> <span class=md-ellipsis> Other Ingress Controllers </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#loadbalancernodeport-service-type class=md-nav__link> <span class=md-ellipsis> LoadBalancer/NodePort Service Type </span> </a> <nav class=md-nav aria-label="LoadBalancer/NodePort Service Type"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nodeport-service-type class=md-nav__link> <span class=md-ellipsis> NodePort Service Type </span> </a> </li> <li class=md-nav__item> <a href=#loadbalancer-service-type class=md-nav__link> <span class=md-ellipsis> LoadBalancer Service Type </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#volumes class=md-nav__link> <span class=md-ellipsis> Volumes </span> </a> <nav class=md-nav aria-label=Volumes> <ul class=md-nav__list> <li class=md-nav__item> <a href=#volumes-configuration class=md-nav__link> <span class=md-ellipsis> Volumes configuration </span> </a> </li> <li class=md-nav__item> <a href=#volumes-examples class=md-nav__link> <span class=md-ellipsis> Volumes examples </span> </a> </li> <li class=md-nav__item> <a href=#additional-volumes class=md-nav__link> <span class=md-ellipsis> Additional volumes </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#database-connectivity class=md-nav__link> <span class=md-ellipsis> Database connectivity </span> </a> <nav class=md-nav aria-label="Database connectivity"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#databaseurl class=md-nav__link> <span class=md-ellipsis> database.url </span> </a> </li> <li class=md-nav__item> <a href=#databasedriver class=md-nav__link> <span class=md-ellipsis> database.driver </span> </a> </li> <li class=md-nav__item> <a href=#databasetype class=md-nav__link> <span class=md-ellipsis> database.type </span> </a> </li> <li class=md-nav__item> <a href=#databasecredentials class=md-nav__link> <span class=md-ellipsis> database.credentials </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#namespace class=md-nav__link> <span class=md-ellipsis> Namespace </span> </a> </li> <li class=md-nav__item> <a href=#clustering class=md-nav__link> <span class=md-ellipsis> Clustering </span> </a> </li> <li class=md-nav__item> <a href=#generating-configuration-files class=md-nav__link> <span class=md-ellipsis> Generating configuration files </span> </a> </li> <li class=md-nav__item> <a href=#additional-libraries-plugins class=md-nav__link> <span class=md-ellipsis> Additional libraries &amp; plugins </span> </a> <nav class=md-nav aria-label="Additional libraries & plugins"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#p1-plugins class=md-nav__link> <span class=md-ellipsis> P1 Plugins </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#cpu-and-memory-requests class=md-nav__link> <span class=md-ellipsis> CPU and memory requests </span> </a> </li> <li class=md-nav__item> <a href=#additional-containers class=md-nav__link> <span class=md-ellipsis> Additional containers </span> </a> </li> <li class=md-nav__item> <a href=#additional-options class=md-nav__link> <span class=md-ellipsis> Additional options </span> </a> </li> <li class=md-nav__item> <a href=#startup-readiness-and-liveness-probes class=md-nav__link> <span class=md-ellipsis> Startup, Readiness and Liveness Probes </span> </a> <nav class=md-nav aria-label="Startup, Readiness and Liveness Probes"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#readiness-probe class=md-nav__link> <span class=md-ellipsis> Readiness Probe </span> </a> </li> <li class=md-nav__item> <a href=#startup-and-liveness-probes class=md-nav__link> <span class=md-ellipsis> Startup and Liveness Probes </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#self-signed-certificates class=md-nav__link> <span class=md-ellipsis> Self Signed Certificates </span> </a> </li> <li class=md-nav__item> <a href=#atlassian-support-and-analytics class=md-nav__link> <span class=md-ellipsis> Atlassian Support and Analytics </span> </a> </li> <li class=md-nav__item> <a href=#tunnels class=md-nav__link> <span class=md-ellipsis> Tunnels </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../MIGRATION/ class=md-nav__link> <span class=md-ellipsis> Migration </span> </a> </li> <li class=md-nav__item> <a href=../OPERATION/ class=md-nav__link> <span class=md-ellipsis> Operation </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_7> <label class=md-nav__link for=__nav_2_7 id=__nav_2_7_label tabindex=0> <span class=md-ellipsis> Monitoring </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_7_label aria-expanded=false> <label class=md-nav__title for=__nav_2_7> <span class="md-nav__icon md-icon"></span> Monitoring </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../monitoring/PROMETHEUS/ class=md-nav__link> <span class=md-ellipsis> Prometheus and Grafana </span> </a> </li> <li class=md-nav__item> <a href=../monitoring/PRE_CANNED_CHARTS/ class=md-nav__link> <span class=md-ellipsis> Product specific dashboards </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_8> <label class=md-nav__link for=__nav_2_8 id=__nav_2_8_label tabindex=0> <span class=md-ellipsis> Upgrades </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_8_label aria-expanded=false> <label class=md-nav__title for=__nav_2_8> <span class="md-nav__icon md-icon"></span> Upgrades </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../upgrades/HELM_CHART_UPGRADE/ class=md-nav__link> <span class=md-ellipsis> Helm chart upgrade </span> </a> </li> <li class=md-nav__item> <a href=../upgrades/PRODUCTS_UPGRADE/ class=md-nav__link> <span class=md-ellipsis> Products upgrade </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_9> <label class=md-nav__link for=__nav_2_9 id=__nav_2_9_label tabindex=0> <span class=md-ellipsis> Resource management </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_9_label aria-expanded=false> <label class=md-nav__title for=__nav_2_9> <span class="md-nav__icon md-icon"></span> Resource management </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../resource_management/JIRA_INDEX_SNAPSHOT/ class=md-nav__link> <span class=md-ellipsis> Creating an initial index snapshot in Jira </span> </a> </li> <li class=md-nav__item> <a href=../resource_management/REQUESTS_AND_LIMITS/ class=md-nav__link> <span class=md-ellipsis> Resource requests and limits </span> </a> </li> <li class=md-nav__item> <a href=../resource_management/RESOURCE_SCALING/ class=md-nav__link> <span class=md-ellipsis> Product scaling </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Examples </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../examples/EXAMPLES/ class=md-nav__link> <span class=md-ellipsis> Available examples </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0> <span class=md-ellipsis> Kubernetes cluster </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Kubernetes cluster </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../examples/cluster/AKS_SETUP/ class=md-nav__link> <span class=md-ellipsis> Preparing an AKS cluster </span> </a> </li> <li class=md-nav__item> <a href=../../examples/cluster/CLOUD_PROVIDERS/ class=md-nav__link> <span class=md-ellipsis> Provisioning Kubernetes clusters on cloud-based providers </span> </a> </li> <li class=md-nav__item> <a href=../../examples/cluster/EKS_SETUP/ class=md-nav__link> <span class=md-ellipsis> Preparing an EKS cluster </span> </a> </li> <li class=md-nav__item> <a href=../../examples/cluster/GKE_SETUP/ class=md-nav__link> <span class=md-ellipsis> Preparing an GKE cluster </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex=0> <span class=md-ellipsis> Database </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Database </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../examples/database/AMAZON_RDS/ class=md-nav__link> <span class=md-ellipsis> Creating an RDS database instance </span> </a> </li> <li class=md-nav__item> <a href=../../examples/database/CLOUD_PROVIDERS/ class=md-nav__link> <span class=md-ellipsis> Provisioning databases on cloud-based providers </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4 id=__nav_3_4_label tabindex=0> <span class=md-ellipsis> Ingress </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Ingress </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../examples/ingress/CONTROLLERS/ class=md-nav__link> <span class=md-ellipsis> Provisioning an Ingress controller </span> </a> </li> <li class=md-nav__item> <a href=../../examples/ingress/DNS/ class=md-nav__link> <span class=md-ellipsis> Create DNS record via AWS CLI </span> </a> </li> <li class=md-nav__item> <a href=../../examples/ingress/INGRESS_NGINX/ class=md-nav__link> <span class=md-ellipsis> NGINX Ingress Controller - with TLS termination </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_5> <label class=md-nav__link for=__nav_3_5 id=__nav_3_5_label tabindex=0> <span class=md-ellipsis> Storage </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_5_label aria-expanded=false> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> Storage </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../examples/storage/STORAGE/ class=md-nav__link> <span class=md-ellipsis> Shared storage </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_5_2> <label class=md-nav__link for=__nav_3_5_2 id=__nav_3_5_2_label tabindex=0> <span class=md-ellipsis> AWS </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_5_2> <span class="md-nav__icon md-icon"></span> AWS </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../examples/storage/aws/LOCAL_STORAGE/ class=md-nav__link> <span class=md-ellipsis> Local storage </span> </a> </li> <li class=md-nav__item> <a href=../../examples/storage/aws/SHARED_STORAGE/ class=md-nav__link> <span class=md-ellipsis> Shared storage </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_5_2_3> <label class=md-nav__link for=__nav_3_5_2_3 id=__nav_3_5_2_3_label tabindex=0> <span class=md-ellipsis> S3 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_3_5_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_5_2_3> <span class="md-nav__icon md-icon"></span> S3 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../examples/storage/aws/s3/CONFLUENCE/ class=md-nav__link> <span class=md-ellipsis> AWS S3 Attachments Storage </span> </a> </li> <li class=md-nav__item> <a href=../../examples/storage/aws/s3/JIRA/ class=md-nav__link> <span class=md-ellipsis> AWS S3 Avatars Storage </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_5_3> <label class=md-nav__link for=__nav_3_5_3 id=__nav_3_5_3_label tabindex=0> <span class=md-ellipsis> NFS </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_5_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_5_3> <span class="md-nav__icon md-icon"></span> NFS </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../examples/storage/nfs/NFS/ class=md-nav__link> <span class=md-ellipsis> NFS server for Bitbucket </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_5_4> <label class=md-nav__link for=__nav_3_5_4 id=__nav_3_5_4_label tabindex=0> <span class=md-ellipsis> Additional Storage </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_5_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_5_4> <span class="md-nav__icon md-icon"></span> Additional Storage </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../examples/storage/additional%20storage/ADDTIONAL_STORAGE/ class=md-nav__link> <span class=md-ellipsis> Additional Storage </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_6> <label class=md-nav__link for=__nav_3_6 id=__nav_3_6_label tabindex=0> <span class=md-ellipsis> Bamboo </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_6_label aria-expanded=false> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> Bamboo </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../examples/bamboo/REMOTE_AGENTS/ class=md-nav__link> <span class=md-ellipsis> Remote agents </span> </a> </li> <li class=md-nav__item> <a href=../../examples/bamboo/AGENT_CAPABILITIES/ class=md-nav__link> <span class=md-ellipsis> Agent capabilities </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_7> <label class=md-nav__link for=__nav_3_7 id=__nav_3_7_label tabindex=0> <span class=md-ellipsis> Bitbucket </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_7_label aria-expanded=false> <label class=md-nav__title for=__nav_3_7> <span class="md-nav__icon md-icon"></span> Bitbucket </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../examples/bitbucket/BITBUCKET_OPENSEARCH/ class=md-nav__link> <span class=md-ellipsis> OpenSearch </span> </a> </li> <li class=md-nav__item> <a href=../../examples/bitbucket/BITBUCKET_ELASTICSEARCH/ class=md-nav__link> <span class=md-ellipsis> Elasticsearch (Deprecated) </span> </a> </li> <li class=md-nav__item> <a href=../../examples/bitbucket/BITBUCKET_MIRRORS/ class=md-nav__link> <span class=md-ellipsis> Smart Mirrors </span> </a> </li> <li class=md-nav__item> <a href=../../examples/bitbucket/BITBUCKET_SSH/ class=md-nav__link> <span class=md-ellipsis> SSH </span> </a> </li> <li class=md-nav__item> <a href=../../examples/bitbucket/BITBUCKET_MESH/ class=md-nav__link> <span class=md-ellipsis> Mesh </span> </a> </li> <li class=md-nav__item> <a href=../../examples/bitbucket/BITBUCKET_AWS_OPENSEARCH/ class=md-nav__link> <span class=md-ellipsis> Configure AWS OpenSearch with Bitbucket </span> </a> </li> <li class=md-nav__item> <a href=../../examples/bitbucket/BITBUCKET_SESSION_AFFINITY/ class=md-nav__link> <span class=md-ellipsis> Configure Session Stickiness with NGINX Ingress </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_8> <label class=md-nav__link for=__nav_3_8 id=__nav_3_8_label tabindex=0> <span class=md-ellipsis> Confluence </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_8_label aria-expanded=false> <label class=md-nav__title for=__nav_3_8> <span class="md-nav__icon md-icon"></span> Confluence </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../examples/confluence/CONFLUENCE_OPENSEARCH/ class=md-nav__link> <span class=md-ellipsis> Configuring OpenSearch for Confluence </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../examples/logging/efk/EFK/ class=md-nav__link> <span class=md-ellipsis> Logging in a Kubernetes environment </span> </a> </li> <li class=md-nav__item> <a href=../../examples/external_libraries/EXTERNAL_LIBS/ class=md-nav__link> <span class=md-ellipsis> External libraries and plugins </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Troubleshooting </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Troubleshooting </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../troubleshooting/TROUBLESHOOTING/ class=md-nav__link> <span class=md-ellipsis> Troubleshooting tips </span> </a> </li> <li class=md-nav__item> <a href=../../troubleshooting/SUPPORT_BOUNDARIES/ class=md-nav__link> <span class=md-ellipsis> Support boundaries </span> </a> </li> <li class=md-nav__item> <a href=../../troubleshooting/LIMITATIONS/ class=md-nav__link> <span class=md-ellipsis> Limitations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Platforms </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Platforms </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../platforms/PLATFORMS/ class=md-nav__link> <span class=md-ellipsis> Platform information </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_2> <label class=md-nav__link for=__nav_5_2 id=__nav_5_2_label tabindex=0> <span class=md-ellipsis> Openshift </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> Openshift </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../platforms/openshift/OPENSHIFT/ class=md-nav__link> <span class=md-ellipsis> Deploy To OpenShift </span> </a> </li> <li class=md-nav__item> <a href=../../platforms/openshift/OPENSHIFT_FAQ/ class=md-nav__link> <span class=md-ellipsis> OpenShift FAQs </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Containers </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Containers </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../containers/JIRA/ class=md-nav__link> <span class=md-ellipsis> Jira </span> </a> </li> <li class=md-nav__item> <a href=../../containers/CONFLUENCE/ class=md-nav__link> <span class=md-ellipsis> Confluence </span> </a> </li> <li class=md-nav__item> <a href=../../containers/BITBUCKET/ class=md-nav__link> <span class=md-ellipsis> Bitbucket </span> </a> </li> <li class=md-nav__item> <a href=../../containers/BITBUCKET-MESH/ class=md-nav__link> <span class=md-ellipsis> Bitbucket Mesh </span> </a> </li> <li class=md-nav__item> <a href=../../containers/BAMBOO-AGENT/ class=md-nav__link> <span class=md-ellipsis> Bamboo Agent </span> </a> </li> <li class=md-nav__item> <a href=../../containers/BAMBOO/ class=md-nav__link> <span class=md-ellipsis> Bamboo </span> </a> </li> <li class=md-nav__item> <a href=../../containers/CROWD/ class=md-nav__link> <span class=md-ellipsis> Crowd </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#ingress class=md-nav__link> <span class=md-ellipsis> Ingress </span> </a> </li> <li class=md-nav__item> <a href=#session-stickiness-for-high-availability class=md-nav__link> <span class=md-ellipsis> Session Stickiness for High Availability </span> </a> <nav class=md-nav aria-label="Session Stickiness for High Availability"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nginx-ingress-controller class=md-nav__link> <span class=md-ellipsis> NGINX Ingress Controller </span> </a> <nav class=md-nav aria-label="NGINX Ingress Controller"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#custom-configuration class=md-nav__link> <span class=md-ellipsis> Custom Configuration </span> </a> </li> <li class=md-nav__item> <a href=#verify-configuration class=md-nav__link> <span class=md-ellipsis> Verify Configuration </span> </a> </li> <li class=md-nav__item> <a href=#common-issues class=md-nav__link> <span class=md-ellipsis> Common Issues </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#other-ingress-controllers class=md-nav__link> <span class=md-ellipsis> Other Ingress Controllers </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#loadbalancernodeport-service-type class=md-nav__link> <span class=md-ellipsis> LoadBalancer/NodePort Service Type </span> </a> <nav class=md-nav aria-label="LoadBalancer/NodePort Service Type"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nodeport-service-type class=md-nav__link> <span class=md-ellipsis> NodePort Service Type </span> </a> </li> <li class=md-nav__item> <a href=#loadbalancer-service-type class=md-nav__link> <span class=md-ellipsis> LoadBalancer Service Type </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#volumes class=md-nav__link> <span class=md-ellipsis> Volumes </span> </a> <nav class=md-nav aria-label=Volumes> <ul class=md-nav__list> <li class=md-nav__item> <a href=#volumes-configuration class=md-nav__link> <span class=md-ellipsis> Volumes configuration </span> </a> </li> <li class=md-nav__item> <a href=#volumes-examples class=md-nav__link> <span class=md-ellipsis> Volumes examples </span> </a> </li> <li class=md-nav__item> <a href=#additional-volumes class=md-nav__link> <span class=md-ellipsis> Additional volumes </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#database-connectivity class=md-nav__link> <span class=md-ellipsis> Database connectivity </span> </a> <nav class=md-nav aria-label="Database connectivity"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#databaseurl class=md-nav__link> <span class=md-ellipsis> database.url </span> </a> </li> <li class=md-nav__item> <a href=#databasedriver class=md-nav__link> <span class=md-ellipsis> database.driver </span> </a> </li> <li class=md-nav__item> <a href=#databasetype class=md-nav__link> <span class=md-ellipsis> database.type </span> </a> </li> <li class=md-nav__item> <a href=#databasecredentials class=md-nav__link> <span class=md-ellipsis> database.credentials </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#namespace class=md-nav__link> <span class=md-ellipsis> Namespace </span> </a> </li> <li class=md-nav__item> <a href=#clustering class=md-nav__link> <span class=md-ellipsis> Clustering </span> </a> </li> <li class=md-nav__item> <a href=#generating-configuration-files class=md-nav__link> <span class=md-ellipsis> Generating configuration files </span> </a> </li> <li class=md-nav__item> <a href=#additional-libraries-plugins class=md-nav__link> <span class=md-ellipsis> Additional libraries &amp; plugins </span> </a> <nav class=md-nav aria-label="Additional libraries & plugins"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#p1-plugins class=md-nav__link> <span class=md-ellipsis> P1 Plugins </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#cpu-and-memory-requests class=md-nav__link> <span class=md-ellipsis> CPU and memory requests </span> </a> </li> <li class=md-nav__item> <a href=#additional-containers class=md-nav__link> <span class=md-ellipsis> Additional containers </span> </a> </li> <li class=md-nav__item> <a href=#additional-options class=md-nav__link> <span class=md-ellipsis> Additional options </span> </a> </li> <li class=md-nav__item> <a href=#startup-readiness-and-liveness-probes class=md-nav__link> <span class=md-ellipsis> Startup, Readiness and Liveness Probes </span> </a> <nav class=md-nav aria-label="Startup, Readiness and Liveness Probes"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#readiness-probe class=md-nav__link> <span class=md-ellipsis> Readiness Probe </span> </a> </li> <li class=md-nav__item> <a href=#startup-and-liveness-probes class=md-nav__link> <span class=md-ellipsis> Startup and Liveness Probes </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#self-signed-certificates class=md-nav__link> <span class=md-ellipsis> Self Signed Certificates </span> </a> </li> <li class=md-nav__item> <a href=#atlassian-support-and-analytics class=md-nav__link> <span class=md-ellipsis> Atlassian Support and Analytics </span> </a> </li> <li class=md-nav__item> <a href=#tunnels class=md-nav__link> <span class=md-ellipsis> Tunnels </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=configuration>Configuration<a class=headerlink href=#configuration title="Permanent link"> ¶</a></h1> <h2 id=ingress><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 4v8.5l3-3L9 13c1 1 1 2 1 2v6h4v-7s0-1-.53-2S12 10 12 10L9 6.58 11.5 4M18 4l-4.46 4.47L14 9s.93 1 1.47 2c.21.4.33.79.4 1.13L21 7"/></svg></span> Ingress<a class=headerlink href=#ingress title="Permanent link"> ¶</a></h2> <p>In order to make the Atlassian product available from outside of the Kubernetes cluster, a suitable HTTP/HTTPS ingress controller needs to be installed. The standard Kubernetes Ingress resource is not flexible enough for our needs, so a third-party ingress controller and resource definition must be provided. The exact details of the Ingress will be highly site-specific. These Helm charts were tested using the <a href=https://kubernetes.github.io/ingress-nginx/ class=external>NGINX Ingress Controller</a>. We also provide <a href=../../examples/ingress/CONTROLLERS/ >example instructions</a> on how this controller can be installed and configured.</p> <p>The charts themselves provide a template for Ingress resource rules to be utilised by the provisioned controller. These include all required annotations and optional TLS configuration for the NGINX Ingress Controller.</p> <p>Some key considerations to note when configuring the controller are:</p> <div class="admonition ingress requirements"> <p class=admonition-title>Ingress</p> <ul> <li>At a minimum, the ingress needs the ability to support long request timeouts, as well as session affinity (aka "sticky sessions").</li> <li> <p>The Ingress Resource provided as part of the Helm charts is geared toward the <a href=https://kubernetes.github.io/ingress-nginx/ class=external>NGINX Ingress Controller</a> and can be configured via the <code>ingress</code> stanza in the appropriate <code>values.yaml</code>. Some key aspects that can be configured include:</p> <ul> <li>Usage of the NGINX Ingress Controller</li> <li>Ingress Controller annotations</li> <li>The request max body size</li> <li>The hostname of the ingress resource</li> </ul> </li> <li> <p>When installed, with the provided <a href=https://kubernetes.github.io/ingress-nginx/deploy/ class=external>configuration</a>, the NGINX Ingress Controller will provision an internet-facing (see diagram below) load balancer on your behalf. The load balancer should either support the <a class=external href=https://www.haproxy.org/download/1.8/doc/proxy-protocol.txt>Proxy Protocol</a> or allow for the forwarding of <code>X-Forwarded-*</code> headers. This ensures any backend redirects are done so over the correct protocol.</p> </li> <li>If the <code>X-Forwarded-*</code> headers are being used, then enable the <a class=external href=https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/configmap/#use-forwarded-headers>use-forwarded-headers</a> option on the controllers <code>ConfigMap</code>. This ensures that these headers are appropriately passed on.</li> <li>The diagram below provides a high-level overview of how external requests are routed via an internet-facing load balancer to the correct service via Ingress.</li> </ul> </div> <p><img alt=ingress-architecture src=../../assets/images/ingress.png title="Request routing via Ingress"></p> <div class="admonition note"> <p class=admonition-title>Traffic flow (diagram)</p> <ol> <li>Inbound client request</li> <li>DNS routes request to appropriate LB</li> <li>LB forwards request to internal Ingress</li> <li>Ingress controller performs traffic routing lookup via Ingress object(s)</li> <li>Ingress forwards request to appropriate service based on Ingress object routing rule</li> <li>Service forwards request to appropriate pod</li> <li>Pod handles request</li> </ol> </div> <div class="admonition info"> <p class=admonition-title>Request body size</p> <p>By default the maximum allowed size for the request body is set to <code>250MB</code>. If the size in a request exceeds the maximum size of the client request body, an <code>413</code> error will be returned to the client. The maximum request body can be configured by changing the value of <code>maxBodySize</code> in <code>values.yaml</code>.</p> </div> <h2 id=session-stickiness-for-high-availability><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 5.5A3.5 3.5 0 0 1 15.5 9a3.5 3.5 0 0 1-3.5 3.5A3.5 3.5 0 0 1 8.5 9 3.5 3.5 0 0 1 12 5.5M5 8c.56 0 1.08.15 1.53.42-.15 1.43.27 2.85 1.13 3.96C7.16 13.34 6.16 14 5 14a3 3 0 0 1-3-3 3 3 0 0 1 3-3m14 0a3 3 0 0 1 3 3 3 3 0 0 1-3 3c-1.16 0-2.16-.66-2.66-1.62a5.54 5.54 0 0 0 1.13-3.96c.45-.27.97-.42 1.53-.42M5.5 18.25c0-2.07 2.91-3.75 6.5-3.75s6.5 1.68 6.5 3.75V20h-13zM0 20v-1.5c0-1.39 1.89-2.56 4.45-2.9-.59.68-.95 1.62-.95 2.65V20zm24 0h-3.5v-1.75c0-1.03-.36-1.97-.95-2.65 2.56.34 4.45 1.51 4.45 2.9z"/></svg></span> Session Stickiness for High Availability<a class=headerlink href=#session-stickiness-for-high-availability title="Permanent link"> ¶</a></h2> <h3 id=nginx-ingress-controller>NGINX Ingress Controller<a class=headerlink href=#nginx-ingress-controller title="Permanent link"> ¶</a></h3> <p>Session stickiness is automatically enabled when using NGINX Ingress Controller:</p> <div class=highlight><pre><span></span><code><span class=nt>ingress</span><span class=p>:</span>
<span class=w>  </span><span class=nt>create</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class=w>  </span><span class=nt>nginx</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class=w>  </span><span class=c1># Automatically enables session stickiness</span>
<span class=w>  </span><span class=nt>host</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">bitbucket.example.com</span>
</code></pre></div> <h4 id=custom-configuration>Custom Configuration<a class=headerlink href=#custom-configuration title="Permanent link"> ¶</a></h4> <div class=highlight><pre><span></span><code><span class=nt>ingress</span><span class=p>:</span>
<span class=w>  </span><span class=nt>create</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class=w>  </span><span class=nt>nginx</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class=w>  </span><span class=nt>host</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">bitbucket.example.com</span>
<span class=w>  </span><span class=nt>annotations</span><span class=p>:</span>
<span class=w>    </span><span class=s>&quot;nginx.ingress.kubernetes.io/session-cookie-name&quot;</span><span class="p p-Indicator">:</span><span class=w> </span><span class=s>&quot;BITBUCKET-SESSION&quot;</span>
<span class=w>    </span><span class=s>&quot;nginx.ingress.kubernetes.io/session-cookie-max-age&quot;</span><span class="p p-Indicator">:</span><span class=w> </span><span class=s>&quot;28800&quot;</span><span class=w>  </span><span class=c1># 8 hours</span>
<span class=w>    </span><span class=s>&quot;nginx.ingress.kubernetes.io/session-cookie-change-on-failure&quot;</span><span class="p p-Indicator">:</span><span class=w> </span><span class=s>&quot;true&quot;</span>
</code></pre></div> <h4 id=verify-configuration>Verify Configuration<a class=headerlink href=#verify-configuration title="Permanent link"> ¶</a></h4> <div class=highlight><pre><span></span><code><span class=c1># Check ingress annotations</span>
kubectl<span class=w> </span>describe<span class=w> </span>ingress<span class=w> </span>bitbucket<span class=w> </span>-n<span class=w> </span>atlassian

<span class=c1># Test with curl (look for Set-Cookie header)</span>
curl<span class=w> </span>-I<span class=w> </span>https://bitbucket.example.com/status
</code></pre></div> <h4 id=common-issues>Common Issues<a class=headerlink href=#common-issues title="Permanent link"> ¶</a></h4> <table> <thead> <tr> <th>Issue</th> <th>Solution</th> </tr> </thead> <tbody> <tr> <td>Users getting logged out randomly</td> <td>Verify session stickiness annotations are applied</td> </tr> <tr> <td>Requests routing to different pods</td> <td>Check if clustering is enabled</td> </tr> <tr> <td>Session cookies not working</td> <td>Ensure ingress controller supports session affinity</td> </tr> </tbody> </table> <h3 id=other-ingress-controllers>Other Ingress Controllers<a class=headerlink href=#other-ingress-controllers title="Permanent link"> ¶</a></h3> <p>For other ingress controllers (AWS ALB, Google Cloud Load Balancer, Azure Application Gateway), refer to your controller's documentation for session stickiness configuration.</p> <h2 id=loadbalancernodeport-service-type><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 4v8.5l3-3L9 13c1 1 1 2 1 2v6h4v-7s0-1-.53-2S12 10 12 10L9 6.58 11.5 4M18 4l-4.46 4.47L14 9s.93 1 1.47 2c.21.4.33.79.4 1.13L21 7"/></svg></span> LoadBalancer/NodePort Service Type<a class=headerlink href=#loadbalancernodeport-service-type title="Permanent link"> ¶</a></h2> <div class="admonition info"> <p class=admonition-title>Feature Availability</p> <p>Service session affinity configuration is available starting from Helm chart version 1.13</p> </div> <p>It is possible to make the Atlassian product available from outside of the Kubernetes cluster without using an ingress controller.</p> <h3 id=nodeport-service-type>NodePort Service Type<a class=headerlink href=#nodeport-service-type title="Permanent link"> ¶</a></h3> <p>When installing Helm release, you can set:</p> <div class=highlight><pre><span></span><code><span class=nt>jira</span><span class=p>:</span>
<span class=w>  </span><span class=nt>service</span><span class=p>:</span>
<span class=w>      </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">NodePort</span>
<span class=w>      </span><span class=nt>sessionAffinity</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ClientIP</span>
<span class=w>      </span><span class=nt>sessionAffinityConfig</span><span class=p>:</span>
<span class=w>        </span><span class=nt>clientIP</span><span class=p>:</span>
<span class=w>          </span><span class=nt>timeoutSeconds</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">10800</span>
</code></pre></div> <p>The service port will be exposed on a random port from the ephemeral port range (<code>30000</code>-<code>32767</code>) on all worker nodes. It is possible to explicitly set NodePort in <code>service.nodePort</code> (make sure it's not reserved for any existing service in the cluster). You can provision a LoadBalancer with <code>443</code> or <code>80</code> (or both) listeners that will forward traffic to the node port (you can get service node port by running <code>kubectl describe $service -n $namespace</code>). Both LoadBalancer and Kubernetes service should be configured to maintain session affinity. LoadBalancer session affinity should be configured as per instructions for your Kubernetes/cloud provider. Service session affinity is configured by overriding the default Helm chart values (see the above example). Make sure you configure networking rules to allow the LoadBalancer to communicate with the Kubernetes cluster worker node on the node port.</p> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>For more information about Kubernetes service session affinity, see <a class=external href=https://kubernetes.io/docs/reference/networking/virtual-ips/#session-affinity>Kubernetes documentation</a>.</p> </div> <h3 id=loadbalancer-service-type>LoadBalancer Service Type<a class=headerlink href=#loadbalancer-service-type title="Permanent link"> ¶</a></h3> <p>LoadBalancer service type is the automated way to expose the service on the node port, create a LoadBalancer for it and configure networking rules allowing communication between the LoadBalancer and the Kubernetes cluster worker nodes:</p> <div class=highlight><pre><span></span><code><span class=nt>jira</span><span class=p>:</span>
<span class=w>  </span><span class=nt>service</span><span class=p>:</span>
<span class=w>      </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">LoadBalancer</span>
<span class=w>      </span><span class=nt>sessionAffinity</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ClientIP</span>
<span class=w>      </span><span class=nt>sessionAffinityConfig</span><span class=p>:</span>
<span class=w>        </span><span class=nt>clientIP</span><span class=p>:</span>
<span class=w>          </span><span class=nt>timeoutSeconds</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">10800</span>
</code></pre></div> <div class="admonition warning"> <p class=admonition-title>AWS EKS users</p> <p>If you install the Helm chart for the first time, you will need to skip overriding <code>sessionAffinity</code> in your <code>values.yaml</code>, otherwise the LoadBalancer will not be created and you will see the following error: <div class=highlight><pre><span></span><code>Error syncing load balancer: failed to ensure load balancer: unsupported load balancer affinity: ClientIP
</code></pre></div> Once the Helm chart is installed with the default <code>sessionAffinity</code>, run <code>helm upgrade</code> with <code>$productName.service.sessionAffinity</code> set to <code>ClientIP</code>.</p> </div> <h2 id=volumes><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 6h-8l-2-2H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2m-3 7v4h-2v-3h-2v3h-2v-4H9l5-4 5 4Z"/></svg></span> Volumes<a class=headerlink href=#volumes title="Permanent link"> ¶</a></h2> <p>The Data Center products make use of filesystem storage. Each DC node has its own <code>local-home</code> volume, and all nodes in the DC cluster share a single <code>shared-home</code> volume.</p> <p>By default, the Helm charts will configure all of these volumes as ephemeral <a class=external href=https://kubernetes.io/docs/concepts/storage/volumes/#emptydir>emptyDir</a> volumes. This makes it possible to install the charts without configuring any volume management, but comes with two big caveats:</p> <ol> <li>Any data stored in the <code>local-home</code> or <code>shared-home</code> will be lost every time a pod starts.</li> <li>Whilst the data that is stored in <code>local-home</code> can generally be regenerated (e.g. from the database), this can be a very expensive process that sometimes requires manual intervention.</li> </ol> <p>For these reasons, the default volume configuration of the Helm charts is suitable only for running a single DC pod for evaluation purposes. Proper volume management needs to be configured in order for the data to survive restarts, and for multi-pod DC clusters to operate correctly.</p> <p>While you are free to configure your Kubernetes volume management in any way you wish, within the constraints imposed by the products, the recommended setup is to use Kubernetes <a href=https://kubernetes.io/docs/concepts/storage/persistent-volumes/ class=external>PersistentVolumes</a> and <code>PersistentVolumeClaims</code>.</p> <p>The <code>local-home</code> volume requires a <code>PersistentVolume</code> with <a class=external href=https://kubernetes.io/docs/concepts/storage/persistent-volumes/#access-modes>ReadWriteOnce (RWO)</a> capability, and <code>shared-home</code> requires a <code>PersistentVolume</code> with <a class=external href=https://kubernetes.io/docs/concepts/storage/persistent-volumes/#access-modes>ReadWriteMany (RWX)</a> capability. Typically, this will be an NFS volume provided as part of your infrastructure, but some public-cloud Kubernetes engines provide their own <code>RWX</code> volumes (e.g. <a href=https://aws.amazon.com/efs/ class=external>AWS EFS</a> and <a class=external href=https://docs.microsoft.com/en-us/azure/storage/files/storage-files-introduction>Azure Files</a>). While this entails a higher upfront setup effort, it gives the best flexibility.</p> <h3 id=volumes-configuration>Volumes configuration<a class=headerlink href=#volumes-configuration title="Permanent link"> ¶</a></h3> <p>By default, the charts will configure the <code>local-home</code> and <code>shared-home</code> values as follows:</p> <div class=highlight><pre><span></span><code><span class=nt>volumes</span><span class=p>:</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">local-home</span>
<span class=w>    </span><span class=nt>emptyDir</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{}</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">shared-home</span>
<span class=w>    </span><span class=nt>emptyDir</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{}</span>
</code></pre></div> <p>As explained above, this default configuration is suitable only for evaluation or testing purposes. Proper volume management needs to be configured.</p> <div class="admonition info"> <p class=admonition-title>Bitbucket default <code>shared-home</code> location</p> <p>For a single node Bitbucket deployment, if no <code>shared-home</code> volume is defined, then a subpath of <code>local-home</code> will automatically be used for this purpose, namely: <code>&lt;LOCAL_HOME_DIRECTORY&gt;/shared</code>. This behaviour is specific to Bitbucket itself and is not orchestrated via the Helm chart.</p> </div> <p>In order to enable the persistence of data stored in these volumes, it is necessary to replace these volumes with something else.</p> <p>The recommended way is to enable the use of <code>PersistentVolume</code> and <code>PersistentVolumeClaim</code> for both volumes, using your install-specific <code>values.yaml</code> file, for example:</p> <div class=highlight><pre><span></span><code><span class=nt>volumes</span><span class=p>:</span>
<span class=w>  </span><span class=nt>localHome</span><span class=p>:</span>
<span class=w>    </span><span class=nt>persistentVolumeClaim</span><span class=p>:</span>
<span class=w>      </span><span class=nt>create</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class=w>  </span><span class=nt>sharedHome</span><span class=p>:</span>
<span class=w>    </span><span class=nt>persistentVolumeClaim</span><span class=p>:</span>
<span class=w>      </span><span class=nt>create</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div> <p>This will result in each pod in the <code>StatefulSet</code> creating a <code>local-home</code> <code>PersistentVolumeClaim</code> of type <code>ReadWriteOnce</code>, and a single <code>PersistentVolumeClaim</code> of type <code>ReadWriteMany</code> being created for the <code>shared-home</code>.</p> <p>For each <code>PersistentVolumeClaim</code> created by the chart, a suitable <code>PersistentVolume</code> needs to be made available prior to installation. These can be provisioned either statically or dynamically, using an auto-provisioner.</p> <p>An alternative to <code>PersistentVolumeClaims</code> is to use inline volume definitions, either for <code>local-home</code> or <code>shared-home</code> (or both), for example:</p> <div class=highlight><pre><span></span><code><span class=nt>volumes</span><span class=p>:</span>
<span class=w>  </span><span class=nt>localHome</span><span class=p>:</span>
<span class=w>    </span><span class=nt>customVolume</span><span class=p>:</span>
<span class=w>      </span><span class=nt>hostPath</span><span class=p>:</span>
<span class=w>        </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/my/data</span>
<span class=w>  </span><span class=nt>sharedHome</span><span class=p>:</span>
<span class=w>    </span><span class=nt>customVolume</span><span class=p>:</span>
<span class=w>      </span><span class=nt>nfs</span><span class=p>:</span>
<span class=w>        </span><span class=nt>server</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">mynfsserver</span>
<span class=w>        </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/export/path</span>
</code></pre></div> <p>Generally, any valid Kubernetes volume resource definition can be substituted here. However, as mentioned previously, externalising the volume definitions using <code>PersistentVolumes</code> is the strongly recommended approach.</p> <h3 id=volumes-examples>Volumes examples<a class=headerlink href=#volumes-examples title="Permanent link"> ¶</a></h3> <ol> <li>Bitbucket needs a dedicated NFS server providing persistence for a shared home if you are not using <a href=../../examples/bitbucket/BITBUCKET_MESH/ >Bitbucket Mesh</a>. Prior to installing the Helm chart, a suitable NFS shared storage solution must be provisioned. The exact details of this resource will be highly site-specific, but you can use this example as a guide: <a href=../../examples/storage/nfs/NFS/ >Implementation of an NFS Server for Bitbucket</a>. Please also review <a href=https://confluence.atlassian.com/display/BitbucketServer/Supported+platforms>Bitbucket Supported platforms</a>.</li> <li>We have an example detailing how an existing EFS filesystem can be created and consumed using static provisioning: <a href=../../examples/storage/aws/SHARED_STORAGE/ >Shared storage - utilizing AWS EFS-backed filesystem</a>.</li> <li>You can also refer to an example on how a Kubernetes cluster and helm deployment can be configured to utilize AWS EBS backed volumes: <a href=../../examples/storage/aws/LOCAL_STORAGE/ >Local storage - utilizing AWS EBS-backed volumes</a>.</li> </ol> <h3 id=additional-volumes>Additional volumes<a class=headerlink href=#additional-volumes title="Permanent link"> ¶</a></h3> <p>In addition to the <code>local-home</code> and <code>shared-home</code> volumes that are always attached to the product pods, you can attach your own volumes for your own purposes, and mount them into the product container. Use the <code>additional</code> (under <code>volumes</code>) and <code>additionalVolumeMounts</code> values to both attach the volumes and mount them in to the product container.</p> <p>This might be useful if, for example, you have a custom plugin that requires its own filesystem storage.</p> <p>Example:</p> <div class=highlight><pre><span></span><code><span class=nt>jira</span><span class=p>:</span>
<span class=w>  </span><span class=nt>additionalVolumeMounts</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>volumeName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">my-volume</span>
<span class=w>      </span><span class=nt>mountPath</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/mount</span>
<span class=nt>volumes</span><span class=p>:</span>
<span class=w>  </span><span class=nt>additional</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">my-volume</span>
<span class=w>      </span><span class=nt>persistentVolumeClaim</span><span class=p>:</span>
<span class=w>        </span><span class=nt>claimName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">my-volume-claim</span>
</code></pre></div> <h2 id=database-connectivity><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 3C7.58 3 4 4.79 4 7s3.58 4 8 4 8-1.79 8-4-3.58-4-8-4M4 9v3c0 2.21 3.58 4 8 4s8-1.79 8-4V9c0 2.21-3.58 4-8 4s-8-1.79-8-4m0 5v3c0 2.21 3.58 4 8 4s8-1.79 8-4v-3c0 2.21-3.58 4-8 4s-8-1.79-8-4"/></svg></span> Database connectivity<a class=headerlink href=#database-connectivity title="Permanent link"> ¶</a></h2> <p>The products need to be supplied with the information they need to connect to the database service. Configuration for each product is mostly the same, with some small differences.</p> <h3 id=databaseurl><code>database.url</code><a class=headerlink href=#databaseurl title="Permanent link"> ¶</a></h3> <p>All products require the JDBC URL of the database. The format if this URL depends on the JDBC driver being used, but some examples are:</p> <table> <thead> <tr> <th>Vendor</th> <th>JDBC driver class</th> <th>Example JDBC URL</th> </tr> </thead> <tbody> <tr> <td>PostgreSQL</td> <td><code>org.postgresql.Driver</code></td> <td><code>jdbc:postgresql://&lt;dbhost&gt;:5432/&lt;dbname&gt;</code></td> </tr> <tr> <td>MySQL</td> <td><code>com.mysql.jdbc.Driver</code></td> <td><code>jdbc:mysql://&lt;dbhost&gt;/&lt;dbname&gt;</code></td> </tr> <tr> <td>SQL Server</td> <td><code>com.microsoft.sqlserver.jdbc.SQLServerDriver</code></td> <td><code>jdbc:sqlserver://&lt;dbhost&gt;:1433;databaseName=&lt;dbname&gt;</code></td> </tr> <tr> <td>Oracle</td> <td><code>oracle.jdbc.OracleDriver</code></td> <td><code>jdbc:oracle:thin:@&lt;dbhost&gt;:1521:&lt;SID&gt;</code></td> </tr> </tbody> </table> <div class="admonition info"> <p class=admonition-title>Database creation</p> <p>The Atlassian product doesn't automatically create the database,<code>&lt;dbname&gt;</code>, in the <code>JDBC URL</code>, so you need to manually create a user and database for the used database instance. Details on how to create product-specific databases can be found below:</p> <div class="tabbed-set tabbed-alternate" data-tabs=1:5><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><input id=__tabbed_1_3 name=__tabbed_1 type=radio><input id=__tabbed_1_4 name=__tabbed_1 type=radio><input id=__tabbed_1_5 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>Jira</label><label for=__tabbed_1_2>Confluence</label><label for=__tabbed_1_3>Bitbucket</label><label for=__tabbed_1_4>Bamboo</label><label for=__tabbed_1_5>Crowd</label></div> <div class=tabbed-content> <div class=tabbed-block> <p><a class=external href=https://confluence.atlassian.com/adminjiraserver/connecting-jira-applications-to-a-database-938846850.html>Connect Jira to an external database</a></p> </div> <div class=tabbed-block> <p><a class=external href=https://confluence.atlassian.com/doc/database-configuration-159764.html#DatabaseConfiguration-Databasesetupsetup>Connect Confluence to an external database</a></p> </div> <div class=tabbed-block> <p><a class=external href=https://confluence.atlassian.com/bitbucketserver/connect-bitbucket-to-an-external-database-776640378.html>Connect Bitbucket to an external database</a></p> </div> <div class=tabbed-block> <p><a class=external href=https://confluence.atlassian.com/bamboo/connecting-bamboo-to-an-external-database-289276815.html>Connect Bamboo to an external database</a></p> </div> <div class=tabbed-block> <p><a class=external href=https://confluence.atlassian.com/crowd/connecting-crowd-to-a-database-4030904.html>Connect Crowd to an external database</a></p> </div> </div> </div> </div> <h3 id=databasedriver><code>database.driver</code><a class=headerlink href=#databasedriver title="Permanent link"> ¶</a></h3> <p>Jira and Bitbucket require the JDBC driver class to be specified (Confluence and Bamboo will autoselect this based on the <code>database.type</code> value, see below). The JDBC driver must correspond to the JDBC URL used; see the table above for example driver classes.</p> <p>Note that the products only ship with certain JDBC drivers installed, depending on the license conditions of those drivers.</p> <div class="admonition warning"> <p class=admonition-title>Non-bundled DB drivers</p> <p>MySQL and Oracle database drivers are not shipped with the products due to licensing restrictions. You will need to provide <a href=#additional-libraries-plugins><code>additionalLibraries</code> configuration</a>.</p> </div> <h3 id=databasetype><code>database.type</code><a class=headerlink href=#databasetype title="Permanent link"> ¶</a></h3> <p>Jira, Confluence and Bamboo all require this value to be specified, this declares the database engine to be used. The acceptable values for this include:</p> <table> <thead> <tr> <th>Vendor</th> <th>Jira</th> <th>Confluence</th> <th>Bamboo</th> </tr> </thead> <tbody> <tr> <td>PostgreSQL</td> <td><code>postgres72</code></td> <td><code>postgresql</code></td> <td><code>postgresql</code></td> </tr> <tr> <td>MySQL</td> <td><code>mysql57</code> / <code>mysql8</code></td> <td><code>mysql</code></td> <td><code>mysql</code></td> </tr> <tr> <td>SQL Server</td> <td><code>mssql</code></td> <td><code>mssql</code></td> <td><code>mssql</code></td> </tr> <tr> <td>Oracle</td> <td><code>oracle10g</code></td> <td><code>oracle</code></td> <td><code>oracle12c</code></td> </tr> <tr> <td>Aurora PostgreSQL</td> <td><code>postgresaurora96</code></td> <td></td> <td></td> </tr> </tbody> </table> <h3 id=databasecredentials><code>database.credentials</code><a class=headerlink href=#databasecredentials title="Permanent link"> ¶</a></h3> <p>All products can have their database connectivity and credentials specified either interactively during first-time setup, or automatically by specifying certain configuration via Kubernetes.</p> <p>Depending on the product, the <code>database.type</code>, <code>database.url</code> and <code>database.driver</code> chart values can be provided. In addition, the database username and password can be provided via a <a href=https://kubernetes.io/docs/concepts/configuration/secret/ class=external>Kubernetes secret</a>, with the secret name specified with the <code>database.credentials.secretName</code> chart value. When all the required information is provided in this way, the database connectivity configuration screen will be bypassed during product setup.</p> <h2 id=namespace><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M256.1 8a120 120 0 1 1 0 240 120 120 0 1 1 0-240m-29.7 296h59.4c6.7 0 13.2.4 19.7 1.1-.9 4.9-1.4 9.9-1.4 15v92.1c0 25.5 10.1 49.9 28.1 67.9l31.9 31.9H77.8c-16.4 0-29.7-13.3-29.7-29.7 0-98.5 79.8-178.3 178.3-178.3m125.7 108.2v-92.1c0-17.7 14.3-32 32-32h92.1c12.7 0 24.9 5.1 33.9 14.1l96 96c18.7 18.7 18.7 49.1 0 67.9L530 542.2c-18.7 18.7-49.1 18.7-67.9 0l-96-96c-9-9-14.1-21.2-14.1-33.9zm104-44.2a24 24 0 1 0-48 0 24 24 0 1 0 48 0"/></svg></span> Namespace<a class=headerlink href=#namespace title="Permanent link"> ¶</a></h2> <p>The Helm charts are not opinionated whether they have a <a href=https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/ class=external>Kubernetes namespace</a> to themselves. If you wish, you can run multiple Helm releases of the same product in the same namespace.</p> <h2 id=clustering><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M248 88h80v48h-80zm-8-56c-26.5 0-48 21.5-48 48v64c0 26.5 21.5 48 48 48h16v32H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h96v32h-16c-26.5 0-48 21.5-48 48v64c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48v-64c0-26.5-21.5-48-48-48h-16v-32h192v32h-16c-26.5 0-48 21.5-48 48v64c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48v-64c0-26.5-21.5-48-48-48h-16v-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H320v-32h16c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zm208 344h8v48h-80v-48zm-256 0h8v48h-80v-48z"/></svg></span> Clustering<a class=headerlink href=#clustering title="Permanent link"> ¶</a></h2> <p>By default, the Helm charts will not configure the products for Data Center clustering. In order to enable clustering, the <code>enabled</code> property for clustering must be set to <code>true</code>.</p> <div class="admonition warning"> <p class=admonition-title>Clustering by default for Crowd</p> <p>Crowd does not offer clustering configuration via Helm Chart. Set <code>crowd.clustering.enabled</code> to <code>true/false</code> in <code>${CROWD_HOME}/shared/crowd.cfg.xml</code> and rollout restart Crowd StatefulSet after the initial product setup is complete.</p> </div> <div class="admonition note"> <div class="tabbed-set tabbed-alternate" data-tabs=2:5><input checked=checked id=__tabbed_2_1 name=__tabbed_2 type=radio><input id=__tabbed_2_2 name=__tabbed_2 type=radio><input id=__tabbed_2_3 name=__tabbed_2 type=radio><input id=__tabbed_2_4 name=__tabbed_2 type=radio><input id=__tabbed_2_5 name=__tabbed_2 type=radio><div class=tabbed-labels><label for=__tabbed_2_1>Jira</label><label for=__tabbed_2_2>Confluence</label><label for=__tabbed_2_3>Bitbucket</label><label for=__tabbed_2_4>Bamboo</label><label for=__tabbed_2_5>Crowd</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=nt>jira</span><span class=p>:</span>
<span class=w>  </span><span class=nt>clustering</span><span class=p>:</span>
<span class=w>    </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=nt>confluence</span><span class=p>:</span>
<span class=w>  </span><span class=nt>clustering</span><span class=p>:</span>
<span class=w>    </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=nt>bitbucket</span><span class=p>:</span>
<span class=w>  </span><span class=nt>clustering</span><span class=p>:</span>
<span class=w>    </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div> </div> <div class=tabbed-block> <p>Because of the limitations outlined under <a href=../../troubleshooting/LIMITATIONS/#cluster-size>Bamboo and clustering</a> the <code>clustering</code> stanza is not available as a configurable property in the Bamboo <code>values.yaml</code>.</p> </div> <div class=tabbed-block> <p>Clustering is enabled by default. To disable clustering, set <code>crowd.clustering.enabled</code> to <code>false</code> in <code>${CROWD_HOME}/shared/crowd.cfg.xml</code> and rollout restart Crowd StatefulSet after the initial product setup is complete.</p> </div> </div> </div> </div> <p>In addition, the <code>shared-home</code> volume must be correctly configured as a <a class=external href=https://kubernetes.io/docs/concepts/storage/persistent-volumes/#access-modes>ReadWriteMany (RWX)</a> filesystem (e.g. NFS, <a href=https://aws.amazon.com/efs/ class=external>AWS EFS</a> and <a class=external href=https://docs.microsoft.com/en-us/azure/storage/files/storage-files-introduction>Azure Files</a>)</p> <h2 id=generating-configuration-files><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 19c0 1.08.25 2.09.68 3H6c-1.11 0-2-.89-2-2V4a2 2 0 0 1 2-2h1v7l2.5-1.5L12 9V2h6a2 2 0 0 1 2 2v8.08c-.33-.05-.66-.08-1-.08-3.87 0-7 3.13-7 7m11.8 1.4c.1 0 .1.1 0 .2l-1 1.7c-.1.1-.2.1-.3.1l-1.2-.4c-.3.2-.5.3-.8.5l-.2 1.3c0 .1-.1.2-.2.2h-2c-.1 0-.2-.1-.3-.2l-.2-1.3c-.3-.1-.6-.3-.8-.5l-1.2.5c-.1 0-.2 0-.3-.1l-1-1.7c-.1-.1 0-.2.1-.3l1.1-.8v-1l-1.1-.8c-.1-.1-.1-.2-.1-.3l1-1.7c.1-.1.2-.1.3-.1l1.2.5c.3-.2.5-.3.8-.5l.2-1.3c0-.1.1-.2.3-.2h2c.1 0 .2.1.2.2l.2 1.3c.3.1.6.3.9.5l1.2-.5c.1 0 .3 0 .3.1l1 1.7c.1.1 0 .2-.1.3l-1.1.8v1zM20.5 19c0-.8-.7-1.5-1.5-1.5s-1.5.7-1.5 1.5.7 1.5 1.5 1.5 1.5-.7 1.5-1.5"/></svg></span> Generating configuration files<a class=headerlink href=#generating-configuration-files title="Permanent link"> ¶</a></h2> <p>The Docker entrypoint scripts generate application configuration on first start; not all of these files are regenerated on subsequent starts. This is deliberate, to avoid race conditions or overwriting manual changes during restarts and upgrades. However, in deployments where configuration is purely specified through the environment (e.g. Kubernetes) this behaviour may be undesirable; this flag forces an update of all generated files.</p> <p>The affected files are: - Jira: <code>dbconfig.xml</code> - Confluence: <code>confluence.cfg.xml</code> - Bamboo: <code>bamboo.cfg.xml</code></p> <p>To force update of the configuration files when pods restart, set <code>&lt;product_name.forceConfigUpdate&gt;</code> to true. You can do it by passing an argument to helm install/update command: <div class=highlight><pre><span></span><code>--set jira.forceConfigUpdate=true
</code></pre></div> or set it in <code>values.yaml</code>:</p> <div class=highlight><pre><span></span><code>jira:
  forceConfigUpdate: true
</code></pre></div> <div class="admonition info"> <p class=admonition-title>Bitbucket and Bitbucket Mesh configuration file</p> <p>It's not possible to generate the Bitbucket and Bitbucket Mesh configuration files. Bitbucket uses <code>${BITBUCKET_HOME}/shared/bitbucket.properties</code>. The properties are from <a href=https://confluence.atlassian.com/bitbucketserver/bitbucket-server-config-properties-776640155.html>bitbucket.properties file</a> and can be provided as environment variables. For example: <div class=highlight><pre><span></span><code><span class=nt>bitbucket</span><span class=p>:</span>
<span class=w>  </span><span class=nt>additionalEnvironmentVariables</span><span class=p>:</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">SEACRH_ENABLED</span>
<span class=w>    </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">PLUGIN_SEARCH_CONFIG_BASEURL</span>
<span class=w>    </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">http://my.opensearch.host</span>
</code></pre></div> Bitbucket Mesh uses <code>${BITBUCKET_HOME}/mesh.properties</code>. The properties are from <a href=https://confluence.atlassian.com/bitbucketserver/mesh-configuration-properties-1128304362.html>mesh.properties file</a> and can be provided as environment variables. For example: <div class=highlight><pre><span></span><code><span class=nt>bitbucket</span><span class=p>:</span>
<span class=w>  </span><span class=nt>mesh</span><span class=p>:</span>
<span class=w>    </span><span class=nt>additionalEnvironmentVariables</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">GIT_PATH_EXECUTABLE</span>
<span class=w>      </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/usr/bin/git</span>
</code></pre></div></p> <p>To translate property into an environment variable:</p> <ul> <li>dot <code>.</code> becomes underscore <code>_</code></li> <li>dash <code>-</code> becomes underscore <code>_</code></li> <li>Example: <code>this.new-property</code> becomes <code>THIS_NEW_PROPERTY</code></li> </ul> </div> <h2 id=additional-libraries-plugins><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 19c0 1.08.25 2.09.68 3H6c-1.11 0-2-.89-2-2V4a2 2 0 0 1 2-2h1v7l2.5-1.5L12 9V2h6a2 2 0 0 1 2 2v8.08c-.33-.05-.66-.08-1-.08-3.87 0-7 3.13-7 7m11.8 1.4c.1 0 .1.1 0 .2l-1 1.7c-.1.1-.2.1-.3.1l-1.2-.4c-.3.2-.5.3-.8.5l-.2 1.3c0 .1-.1.2-.2.2h-2c-.1 0-.2-.1-.3-.2l-.2-1.3c-.3-.1-.6-.3-.8-.5l-1.2.5c-.1 0-.2 0-.3-.1l-1-1.7c-.1-.1 0-.2.1-.3l1.1-.8v-1l-1.1-.8c-.1-.1-.1-.2-.1-.3l1-1.7c.1-.1.2-.1.3-.1l1.2.5c.3-.2.5-.3.8-.5l.2-1.3c0-.1.1-.2.3-.2h2c.1 0 .2.1.2.2l.2 1.3c.3.1.6.3.9.5l1.2-.5c.1 0 .3 0 .3.1l1 1.7c.1.1 0 .2-.1.3l-1.1.8v1zM20.5 19c0-.8-.7-1.5-1.5-1.5s-1.5.7-1.5 1.5.7 1.5 1.5 1.5 1.5-.7 1.5-1.5"/></svg></span> Additional libraries &amp; plugins<a class=headerlink href=#additional-libraries-plugins title="Permanent link"> ¶</a></h2> <p>The products' Docker images contain the default set of bundled libraries and plugins. Additional libraries and plugins can be mounted into the product containers during the Helm install. One such use case for this is mounting <code>JDBC</code> drivers that are not shipped with the products' by default.</p> <p>To make use of this mechanism, the additional files need to be available as part of a Kubernetes volume. Options here include putting them into the <code>shared-home</code> volume that's <a href=../PREREQUISITES/#configure-a-shared-home-volume>required as part of the prerequisites</a>. Alternatively, you can create a custom <code>PersistenVolume</code> for them, as long as it has <code>ReadOnlyMany</code> capability.</p> <div class="admonition info"> <p class=admonition-title>Custom volumes for loading libraries</p> <p>If you're not using the <code>shared-home</code> volume, then you can declare your own custom volume, by following the <a href=#additional-volumes>Additional volumes</a> section above.</p> </div> <p>You could even store the files as a <code>ConfigMap</code> that gets mounted as a volume, but you're likely to run into file size limitations there.</p> <p>Assuming that the existing <code>shared-home</code> volume is used for this, then the only configuration required is to specify the <code>additionalLibraries</code> in your <code>values.yaml</code> file, e.g.</p> <div class=highlight><pre><span></span><code><span class=nt>jira</span><span class=p>:</span>
<span class=w>  </span><span class=nt>additionalLibraries</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>volumeName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">shared-home</span>
<span class=w>      </span><span class=nt>subDirectory</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">mylibs</span>
<span class=w>      </span><span class=nt>fileName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">lib1.jar</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>volumeName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">shared-home</span>
<span class=w>      </span><span class=nt>subDirectory</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">mylibs</span>
<span class=w>      </span><span class=nt>fileName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">lib2.jar</span>
</code></pre></div> <p>This will mount the <code>lib1.jar</code> and <code>lib2.jar</code> from the <code>mylibs</code> sub-directory from <code>shared-home</code> into the appropriate place in the container.</p> <p>Similarly, you can use <code>additionalBundledPlugins</code> to load product plugins into the container.</p> <div class="admonition info"> <p class=admonition-title>System plugin</p> <p>Plugins installed via this method will appear as system plugins rather than user plugins. An alternative to this method is to install the plugins via "Manage Apps" in the product system administration UI.</p> </div> <p>For more details on the above, and how 3rd party libraries can be supplied to a Pod see the example <a href=../../examples/external_libraries/EXTERNAL_LIBS/ >External libraries and plugins</a></p> <h3 id=p1-plugins><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 19c0 1.08.25 2.09.68 3H6c-1.11 0-2-.89-2-2V4a2 2 0 0 1 2-2h1v7l2.5-1.5L12 9V2h6a2 2 0 0 1 2 2v8.08c-.33-.05-.66-.08-1-.08-3.87 0-7 3.13-7 7m11.8 1.4c.1 0 .1.1 0 .2l-1 1.7c-.1.1-.2.1-.3.1l-1.2-.4c-.3.2-.5.3-.8.5l-.2 1.3c0 .1-.1.2-.2.2h-2c-.1 0-.2-.1-.3-.2l-.2-1.3c-.3-.1-.6-.3-.8-.5l-1.2.5c-.1 0-.2 0-.3-.1l-1-1.7c-.1-.1 0-.2.1-.3l1.1-.8v-1l-1.1-.8c-.1-.1-.1-.2-.1-.3l1-1.7c.1-.1.2-.1.3-.1l1.2.5c.3-.2.5-.3.8-.5l.2-1.3c0-.1.1-.2.3-.2h2c.1 0 .2.1.2.2l.2 1.3c.3.1.6.3.9.5l1.2-.5c.1 0 .3 0 .3.1l1 1.7c.1.1 0 .2-.1.3l-1.1.8v1zM20.5 19c0-.8-.7-1.5-1.5-1.5s-1.5.7-1.5 1.5.7 1.5 1.5 1.5 1.5-.7 1.5-1.5"/></svg></span> P1 Plugins<a class=headerlink href=#p1-plugins title="Permanent link"> ¶</a></h3> <p>While <code>additionalLibraries</code> and <code>additionalBundledPlugins</code> will mount files to <code>/opt/atlassian/&lt;product-name&gt;/lib</code> and <code>/opt/atlassian/&lt;product-name&gt;/&lt;product-name&gt;/WEB-INF/atlassian-bundled-plugins</code> respectively, plugins built on <a href=https://confluence.atlassian.com/adminjiraserver/important-directories-and-files-938847744.html#Importantdirectoriesandfiles-%3Cjira-application-dir%3E/atlassian-jira/WEB-INF/lib/ class=external>Atlassian Plugin Framework 1</a> need to be stored in <code>/opt/atlassian/&lt;product-name&gt;/&lt;product-name&gt;/WEB-INF/lib</code>. While there's no dedicated Helm values stanza for P1 plugins, it is fairly easy to persist them (the below example is for Jira deployed in namespace <code>atlassian</code>):</p> <ul> <li> <p>In your shared-home, create a directory called <code>p1-plugins</code>: <div class=highlight><pre><span></span><code>kubectl<span class=w> </span><span class=nb>exec</span><span class=w> </span>-ti<span class=w> </span>jira-0<span class=w> </span>-n<span class=w> </span>atlassian<span class=w> </span><span class=se>\</span>
<span class=w>        </span>--<span class=w> </span>mkdir<span class=w> </span>-p<span class=w> </span>/var/atlassian/application-data/shared-home/p1-plugins
</code></pre></div></p> </li> <li> <p>Copy a P1 plugin to the newly created directory in shared-home: <div class=highlight><pre><span></span><code>kubectl<span class=w> </span>cp<span class=w> </span>hello.jar<span class=w> </span><span class=se>\</span>
<span class=w>  </span>atlassian/jira-0:/var/atlassian/application-data/shared-home/p1-plugins/hello.jar
</code></pre></div></p> </li> <li> <p>Add the following to your custom values: <div class=highlight><pre><span></span><code><span class=nt>jira</span><span class=p>:</span>
<span class=w>  </span><span class=nt>additionalVolumeMounts</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">shared-home</span>
<span class=w>      </span><span class=nt>mountPath</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/opt/atlassian/jira/atlassian-jira/WEB-INF/lib/hello.jar</span>
<span class=w>      </span><span class=nt>subPath</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">p1-plugins/hello.jar</span>
</code></pre></div></p> </li> </ul> <p>Run <code>helm upgrade</code> to find <code>/var/atlassian/application-data/shared-home/p1-plugins/hello.jar</code> mounted into <code>/opt/atlassian/jira/atlassian-jira/WEB-INF/lib</code> in all pods of Jira StatefulSet.</p> <p>You can use the same approach to mount any files from a <code>shared-home</code> volume into any location in the container to persist such files across container restarts.</p> <h2 id=cpu-and-memory-requests><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 16 16"><path d="M6.5.75V2h3V.75a.75.75 0 0 1 1.5 0V2h1.25c.966 0 1.75.784 1.75 1.75V5h1.25a.75.75 0 0 1 0 1.5H14v3h1.25a.75.75 0 0 1 0 1.5H14v1.25A1.75 1.75 0 0 1 12.25 14H11v1.25a.75.75 0 0 1-1.5 0V14h-3v1.25a.75.75 0 0 1-1.5 0V14H3.75A1.75 1.75 0 0 1 2 12.25V11H.75a.75.75 0 0 1 0-1.5H2v-3H.75a.75.75 0 0 1 0-1.5H2V3.75C2 2.784 2.784 2 3.75 2H5V.75a.75.75 0 0 1 1.5 0m5.75 11.75a.25.25 0 0 0 .25-.25v-8.5a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25ZM5.75 5h4.5a.75.75 0 0 1 .75.75v4.5a.75.75 0 0 1-.75.75h-4.5a.75.75 0 0 1-.75-.75v-4.5A.75.75 0 0 1 5.75 5m.75 4.5h3v-3h-3Z"/></svg></span> CPU and memory requests<a class=headerlink href=#cpu-and-memory-requests title="Permanent link"> ¶</a></h2> <p>The Helm charts allow you to specify container-level CPU and memory <a class=external href=https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#requests-and-limits>resource requests and limits</a> e.g.</p> <div class=highlight><pre><span></span><code><span class=nt>jira</span><span class=p>:</span>
<span class=w>  </span><span class=nt>resources</span><span class=p>:</span>
<span class=w>    </span><span class=nt>container</span><span class=p>:</span>
<span class=w>      </span><span class=nt>requests</span><span class=p>:</span>
<span class=w>        </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s>&quot;4&quot;</span>
<span class=w>        </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s>&quot;8G&quot;</span>
</code></pre></div> <div class="admonition tip"> <p>By default, the Helm Charts have no container-level resource limits, however there are default requests that are set.</p> </div> <p>Specifying these values is fine for CPU limits/requests, but for memory resources it is also necessary to configure the JVM's memory limits. By default, the JVM maximum heap size is set to 1 GB, so if you increase (or decrease) the container memory resources as above, you also need to change the JVM's max heap size, otherwise the JVM won't take advantage of the extra available memory (or it'll crash if there isn't enough).</p> <p>You specify the JVM memory limits like this:</p> <div class=highlight><pre><span></span><code><span class=nt>jira</span><span class=p>:</span>
<span class=w>  </span><span class=nt>resources</span><span class=p>:</span>
<span class=w>    </span><span class=nt>jvm</span><span class=p>:</span>
<span class=w>      </span><span class=nt>maxHeap</span><span class=p>:</span><span class=w> </span><span class=s>&quot;8g&quot;</span>
</code></pre></div> <p>Another difficulty for specifying memory resources is that the JVM requires additional overheads over and above the max heap size, and the container resources need to take account of that. A safe rule-of-thumb would be for the container to request 2x the value of the max heap for the JVM.</p> <p>This requirement to configure both the container memory and JVM heap will hopefully be removed.</p> <p>You can read more about <a href=../resource_management/RESOURCE_SCALING/#vertical-scaling-adding-resources>resource scaling</a> and <a href=../resource_management/REQUESTS_AND_LIMITS/ >resource requests and limits</a>.</p> <h2 id=additional-containers><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 16 16"><path d="m10.41.24 4.711 2.774c.544.316.878.897.879 1.526v5.01a1.77 1.77 0 0 1-.88 1.53l-7.753 4.521-.002.001a1.77 1.77 0 0 1-1.774 0H5.59L.873 12.85A1.76 1.76 0 0 1 0 11.327V6.292c0-.304.078-.598.22-.855l.004-.005.01-.019c.15-.262.369-.486.64-.643L8.641.239a1.75 1.75 0 0 1 1.765 0l.002.001ZM9.397 1.534l-7.17 4.182 4.116 2.388a.27.27 0 0 0 .269 0l7.152-4.148-4.115-2.422a.25.25 0 0 0-.252 0m-7.768 10.02 4.1 2.393V9.474a2 2 0 0 1-.138-.072L1.5 7.029v4.298c0 .095.05.181.129.227m8.6.642 1.521-.887v-4.45l-1.521.882ZM7.365 9.402h.001q-.066.038-.136.071v4.472l1.5-.875V8.61Zm5.885 1.032 1.115-.65h.002a.27.27 0 0 0 .133-.232V5.264l-1.25.725Z"/></svg></span> Additional containers<a class=headerlink href=#additional-containers title="Permanent link"> ¶</a></h2> <p>The Helm charts allow you to add your own <code>container</code> and <a href=https://kubernetes.io/docs/concepts/workloads/pods/init-containers/ class=external>initContainer</a> entries to the product pods. Use the <code>additionalContainers</code> and <code>additionalInitContainers</code> stanzas within the <code>values.yaml</code> for this. One use-case for an additional container would be to attach a sidecar container to the product pods.</p> <h2 id=additional-options><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 16v-6h2v6a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2V4c0-1.11.89-2 2-2h8v2H8v12zm-9.09-8.92L14 10.17l6.59-6.59L22 5l-8 8-4.5-4.5zM16 20v2H4a2 2 0 0 1-2-2V7h2v13z"/></svg></span> Additional options<a class=headerlink href=#additional-options title="Permanent link"> ¶</a></h2> <p>The Helm charts also allow you to specify:</p> <ul> <li><a href=https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/ class=external><code>additionalLabels</code></a></li> <li><a href=https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/ class=external><code>tolerations</code></a>,</li> <li><a class=external href=https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector><code>nodeSelectors</code></a> </li> <li><a class=external href=https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#affinity-and-anti-affinity><code>affinities</code></a>.</li> <li><a class=external href=https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/#start-ordinal><code>ordinals</code></a>.</li> </ul> <p>These are standard Kubernetes structures that will be included in the pods.</p> <h2 id=startup-readiness-and-liveness-probes><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13.95 13.5h-.23c-.18.11-.26.32-.18.5l.86 2.11c.83-.53 1.46-1.32 1.79-2.25l-2.23-.36zm-3.45.29a.415.415 0 0 0-.38-.29h-.08l-2.22.37c.33.92.96 1.7 1.79 2.23l.85-2.07V14c.04-.05.04-.14.04-.21m1.83.81a.38.38 0 0 0-.51-.15c-.07.05-.12.08-.15.15h-.01l-1.09 1.97c.78.26 1.62.31 2.43.12.14-.03.29-.07.43-.12l-1.09-1.97zm3.45-4.57L14.1 11.5l.01.03a.37.37 0 0 0-.04.53q.075.09.18.12l.01.01 2.17.62c.07-.97-.14-1.95-.65-2.78m-3.11.16c.01.21.18.37.39.36.08 0 .15-.02.21-.05h.01l1.83-1.31a4.45 4.45 0 0 0-2.57-1.24zm-1.94.31c.17.11.4.08.52-.09.05-.06.07-.13.08-.21h.01l.12-2.25c-.15.02-.3.05-.46.08-.8.18-1.54.58-2.12 1.16l1.84 1.31zm-.99 1.69c.2-.05.32-.26.26-.46 0-.08-.05-.14-.11-.19v-.01L8.21 10c-.52.86-.74 1.84-.63 2.82l2.16-.62zm1.64.66.62.3.62-.3.15-.67-.43-.53h-.69l-.43.53zm10.89 1.32L20.5 6.5c-.09-.42-.37-.76-.74-.94l-7.17-3.43c-.37-.17-.81-.17-1.19 0L4.24 5.56c-.37.18-.65.52-.74.94l-1.77 7.67c-.05.2-.05.4 0 .59.01.06.03.12.05.18.03.09.08.19.13.27.03.04.05.08.09.11l4.95 6.18c.02 0 .05.04.05.06.1.09.19.16.28.22.12.08.26.14.4.17.11.05.23.05.32.05h8.12c.07 0 .14-.03.2-.05.05-.01.1-.03.14-.04.04-.02.07-.03.11-.05.05-.02.1-.05.15-.08.12-.08.23-.18.33-.28l.15-.2 4.8-5.98c.1-.12.17-.25.22-.38.02-.06.04-.12.05-.18.05-.19.05-.4 0-.59m-7.43 2.99c.02.06.04.12.07.17-.04.08-.06.17-.03.26.12.24.23.46.38.68.08.11.16.23.24.34 0 .03.03.08.04.12.12.2.06.46-.15.59s-.47.05-.59-.15c-.01-.03-.02-.05-.03-.08-.02-.03-.04-.09-.06-.09-.05-.15-.09-.28-.12-.41-.09-.25-.17-.49-.3-.72a.38.38 0 0 0-.21-.14l-.08-.16c-1.29.48-2.7.48-3.97-.01l-.1.18c-.07.01-.14.04-.19.09-.14.24-.24.49-.33.77-.03.13-.07.26-.12.4-.02 0-.04.07-.06.1a.43.43 0 0 1-.81-.29c.01-.03.03-.05.04-.08.04-.03.04-.08.04-.11.09-.12.16-.23.24-.35.16-.21.29-.45.39-.69a.54.54 0 0 0-.03-.25l.07-.18a5.6 5.6 0 0 1-2.47-3.09l-.2.03a.4.4 0 0 0-.23-.09c-.27.05-.51.13-.77.22-.11.06-.24.11-.37.15-.03.01-.07.02-.13.03a.44.44 0 0 1-.54-.27c-.07-.23.04-.47.28-.55.02 0 .05-.01.08-.01v-.01h.01l.11-.02c.14-.04.28-.04.41-.04.26 0 .52-.06.77-.12.08-.05.14-.11.19-.19l.19-.05c-.21-1.36.1-2.73.86-3.87l-.14-.12c0-.09-.03-.18-.08-.25-.2-.17-.41-.32-.64-.45q-.18-.09-.36-.21c-.02-.02-.06-.05-.08-.07l-.01-.01c-.2-.16-.25-.42-.11-.63.09-.1.21-.15.35-.15q.165.015.3.12l.09.07c.1.09.19.2.28.3.18.19.37.37.58.52.08.04.17.05.26.03l.15.11c.75-.8 1.73-1.36 2.8-1.6.25-.06.52-.1.78-.12l.01-.18a.45.45 0 0 0 .14-.23c.01-.26-.01-.52-.05-.77-.03-.13-.05-.27-.06-.41V5.1c-.02-.24.15-.45.39-.48s.44.15.47.38v.22c-.01.14-.03.28-.06.41-.04.25-.06.51-.05.77.02.1.07.17.14.22l.01.19c1.36.12 2.62.73 3.56 1.72l.16-.12c.09.02.18.01.26-.03.21-.15.41-.33.58-.52.09-.1.18-.2.28-.3.03-.02.07-.06.1-.06.17-.18.44-.18.59 0 .19.16.18.43 0 .6 0 .02-.03.04-.06.06a2.495 2.495 0 0 1-.44.28c-.23.13-.45.28-.64.45-.06.07-.09.15-.08.24l-.16.14a5.44 5.44 0 0 1 .88 3.86l.19.05c.04.08.11.14.19.18.25.07.51.11.77.14h.41c.03.03.08.04.12.05.24.03.4.25.37.49-.05.23-.24.4-.48.37-.03-.01-.07-.01-.07-.02v-.01c-.06 0-.1-.01-.14-.02q-.195-.06-.36-.15c-.26-.1-.5-.17-.77-.21-.09 0-.17 0-.23.08-.07-.01-.13-.02-.19-.03-.41 1.31-1.31 2.41-2.47 3.11"/></svg></span> Startup, Readiness and Liveness Probes<a class=headerlink href=#startup-readiness-and-liveness-probes title="Permanent link"> ¶</a></h2> <h3 id=readiness-probe>Readiness Probe<a class=headerlink href=#readiness-probe title="Permanent link"> ¶</a></h3> <p>By default, a <code>readinessProbe</code> is defined for the main (server) container for all Atlassian DC Helm charts. A <code>readinessProbe</code> makes <code>HTTP</code> calls to the application status endpoint (<code>/status</code>). A pod is not marked as ready until the <code>readinessProbe</code> receives an <code>HTTP</code> response code greater than or equal to <code>200</code>, and less than <code>400</code>, indicating success.</p> <p>If a pod is not in a ready state, there is no <a class=external href=https://kubernetes.io/docs/concepts/services-networking/service/#endpoints>endpoint</a> associated with a <a class=external href=https://kubernetes.io/docs/concepts/services-networking/service>service</a>, as a result such a pod receives no traffic (if this is the only pod in the <code>StatefulSet</code>, you may see <code>503</code> response from the <a href=https://kubernetes.io/docs/concepts/services-networking/ingress/ class=external>Ingress</a>).</p> <p>It is possible to disable the <code>readinessProbe</code> (set <code>&lt;product&gt;.readinessProbe.enabled=false</code>) which may make sense if this is the first (cold) start of a DC product in Kubernetes. With a disabled <code>readinessProbe</code>, the pod almost immediately becomes ready after it has been started, and the Ingress URL will take you to a page showing node start process. We strongly recommend enabling the <code>readinessProbe</code> after the application has been fully migrated and setup in Kubernetes.</p> <p>Depending on the dataset size, resources allocation and application configuration, you may want to adjust the <code>readinessProbe</code> to work best for your particular DC workload:</p> <div class=highlight><pre><span></span><code><span class=nt>readinessProbe</span><span class=p>:</span>
<span class=w>  </span><span class=c1># -- Whether to apply the readinessProbe check to pod.</span>
<span class=w>  </span><span class=c1>#</span>
<span class=w>  </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class=w>  </span><span class=c1># -- The initial delay (in seconds) for the container readiness probe,</span>
<span class=w>  </span><span class=c1># after which the probe will start running.</span>
<span class=w>  </span><span class=c1>#</span>
<span class=w>  </span><span class=nt>initialDelaySeconds</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">10</span>

<span class=w>  </span><span class=c1># -- How often (in seconds) the container readiness probe will run</span>
<span class=w>  </span><span class=c1>#</span>
<span class=w>  </span><span class=nt>periodSeconds</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">5</span>

<span class=w>  </span><span class=c1># -- Number of seconds after which the probe times out</span>
<span class=w>  </span><span class=c1>#</span>
<span class=w>  </span><span class=nt>timeoutSeconds</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1</span>

<span class=w>  </span><span class=c1># -- The number of consecutive failures of the container readiness probe</span>
<span class=w>  </span><span class=c1># before the pod fails readiness checks.</span>
<span class=w>  </span><span class=c1>#</span>
<span class=w>  </span><span class=nt>failureThreshold</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
</code></pre></div> <h3 id=startup-and-liveness-probes>Startup and Liveness Probes<a class=headerlink href=#startup-and-liveness-probes title="Permanent link"> ¶</a></h3> <div class="admonition warning"> <p class=admonition-title><code>startupProbe</code> and <code>livenessProbe</code></p> <p>Both <code>startupProbe</code> and <code>livenessProbe</code> are disabled by default. Make sure you go through the <a href=https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/ class=external>Kubernetes documentation</a> before enabling such probes. Misconfiguration can result in unwanted container restarts and failed "cold" starts.</p> </div> <h2 id=self-signed-certificates><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 3c-1.11 0-2 .89-2 2v10a2 2 0 0 0 2 2h8v5l3-3 3 3v-5h2a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2H4m8 2 3 2 3-2v3.5l3 1.5-3 1.5V15l-3-2-3 2v-3.5L9 10l3-1.5zM4 5h5v2H4zm0 4h3v2H4zm0 4h5v2H4z"/></svg></span> Self Signed Certificates<a class=headerlink href=#self-signed-certificates title="Permanent link"> ¶</a></h2> <p>There are 2 ways to add self-signed certificates to Java truststore: from a single secret or multiple secrets.</p> <div class="tabbed-set tabbed-alternate" data-tabs=3:2><input checked=checked id=__tabbed_3_1 name=__tabbed_3 type=radio><input id=__tabbed_3_2 name=__tabbed_3 type=radio><div class=tabbed-labels><label for=__tabbed_3_1>From a single secret</label><label for=__tabbed_3_2>From multiple secrets</label></div> <div class=tabbed-content> <div class=tabbed-block> <ul> <li>Create a <a href=https://kubernetes.io/docs/concepts/configuration/secret/ class=external>Kubernetes secret</a> containing base64-encoded certificate(s). Here's an example <a class=external href=https://kubernetes.io/docs/tasks/configmap-secret/managing-secret-using-kubectl/#use-source-files>kubectl command</a> to create a secret from 2 local files:</li> </ul> <div class=highlight><pre><span></span><code>kubectl<span class=w> </span>create<span class=w> </span>secret<span class=w> </span>generic<span class=w> </span>dev-certificates<span class=w> </span><span class=se>\</span>
<span class=w>    </span>--from-file<span class=o>=</span>stg.crt<span class=o>=</span>./stg.crt<span class=w> </span><span class=se>\</span>
<span class=w>    </span>--from-file<span class=o>=</span>dev.crt<span class=o>=</span>./dev.crt<span class=w> </span>-n<span class=w> </span><span class=nv>$namespace</span>
</code></pre></div> <p>The resulting secret will have the following data:</p> <div class=highlight><pre><span></span><code><span class=nt>data</span><span class=p>:</span>
<span class=w>  </span><span class=nt>stg.crt</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">base64encodedstgcrt</span>
<span class=w>  </span><span class=nt>dev.crt</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">base64encodeddevcrt</span>
</code></pre></div> <div class="admonition info"> <p class=admonition-title>You can have as many keys (certificates) in the secret as required. All keys will be mounted as files to <code>/tmp/crt</code> in the container and imported into Java truststore. In the example above, certificates will be mounted as <code>/tmp/crt/stg.crt</code> and <code>/tmp/crt/dev.crt</code>. File extension in the secret keys does not matter as long as the file is a valid certificate.</p> </div> <ul> <li>Provide the secret name in Helm values (unlike the case with multiple secrets you don't need to provide secret keys):</li> </ul> <div class=highlight><pre><span></span><code><span class=nt>jira</span><span class=p>:</span>
<span class=w>  </span><span class=nt>additionalCertificates</span><span class=p>:</span>
<span class=w>     </span><span class=nt>secretName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">dev-certificates</span>
</code></pre></div> </div> <div class=tabbed-block> <ul> <li>Create 2 <a href=https://kubernetes.io/docs/concepts/configuration/secret/ class=external>Kubernetes secrets</a> containing base64-encoded certificate(s). Here's an example <a class=external href=https://kubernetes.io/docs/tasks/configmap-secret/managing-secret-using-kubectl/#use-source-files>kubectl command</a> to create 2 secrets from local files (the first one with 2 certificates/keys and the second one with just one):</li> </ul> <div class=highlight><pre><span></span><code>kubectl<span class=w> </span>create<span class=w> </span>secret<span class=w> </span>generic<span class=w> </span>dev-certificates<span class=w> </span><span class=se>\</span>
<span class=w>    </span>--from-file<span class=o>=</span>stg.crt<span class=o>=</span>./stg.crt<span class=w> </span><span class=se>\</span>
<span class=w>    </span>--from-file<span class=o>=</span>dev.crt<span class=o>=</span>./dev.crt<span class=w> </span>-n<span class=w> </span><span class=nv>$namespace</span>

kubectl<span class=w> </span>create<span class=w> </span>secret<span class=w> </span>generic<span class=w> </span>root-ca<span class=w> </span><span class=se>\</span>
<span class=w>    </span>--from-file<span class=o>=</span>ca.crt<span class=o>=</span>./ca.crt<span class=w> </span>-n<span class=w> </span><span class=nv>$namespace</span>
</code></pre></div> <div class="admonition info"> <p class=admonition-title>You can have as many keys (certificates) in the secrets, however, you will need to list the keys you'd like to get mounted. All keys will be mounted as files to <code>/tmp/crt</code> in the container and imported into Java truststore.</p> </div> <ul> <li>Provide the list of secrets and their keys in Helm values:</li> </ul> <p><div class=highlight><pre><span></span><code><span class=nt>jira</span><span class=p>:</span>
<span class=w>  </span><span class=nt>additionalCertificates</span><span class=p>:</span>
<span class=w>    </span><span class=nt>secretList</span><span class=p>:</span>
<span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">dev-certificates</span>
<span class=w>        </span><span class=nt>keys</span><span class=p>:</span>
<span class=w>          </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">stg.crt</span>
<span class=w>          </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">dev.crt</span>
<span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">root-ca</span>
<span class=w>        </span><span class=nt>keys</span><span class=p>:</span>
<span class=w>          </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ca.crt</span>
</code></pre></div> To allow having identical keys in different secrets, filenames will have the following format: <code>&lt;secret-name&gt;-&lt;key&gt;</code>, so files will get mounted as <code>/tmp/crt/dev-certificates-stg.crt</code>, <code>/tmp/crt/dev-certificates-dev.crt</code> and <code>/tmp/crt/root-ca-ca.crt</code> and imported to Java truststore with the same aliases.</p> </div> </div> </div> <p>The product Helm chart will add additional <code>volumeMounts</code> and <code>volumes</code> to the pod(s), as well as an extra init container that will:</p> <ul> <li>copy the default Java cacerts to a runtime volume shared between the init container and the main container at <code>/var/ssl</code></li> <li>run <a class=external href=https://docs.oracle.com/javase/8/docs/technotes/tools/unix/keytool.html>keytool -import</a> to import all certificates in <code>/tmp/crt</code> mounted from secret(s) to <code>/var/ssl/cacerts</code></li> <li><code>-Djavax.net.ssl.trustStore=/var/ssl/cacerts</code> system property will be automatically added to <code>JVM_SUPPORT_RECOMMENDED_ARGS</code> environment variable.</li> </ul> <p>If necessary, it is possible to override the default <code>keytool -import</code> command:</p> <div class=highlight><pre><span></span><code><span class=nt>jira</span><span class=p>:</span>
<span class=w>  </span><span class=nt>additionalCertificates</span><span class=p>:</span>
<span class=w>     </span><span class=nt>secretName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">dev-certificates</span>
<span class=w>     </span><span class=nt>customCmd</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">keytool -import ...</span>
</code></pre></div> <h2 id=atlassian-support-and-analytics><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 3 2 12h3v8h14v-8h3M9 18H7v-6h2m4 6h-2v-8h2m4 8h-2v-4h2"/></svg></span> Atlassian Support and Analytics<a class=headerlink href=#atlassian-support-and-analytics title="Permanent link"> ¶</a></h2> <p>Starting from <code>1.17.0</code> Helm chart version, by default, an additional <code>ConfigMap</code> is created and mounted into <code>/opt/atlassian/helm</code> in the containers. This <code>ConfigMap</code> has 2 keys: <code>values.yaml</code> and <code>analytics.json</code> that are picked up by the <a class=external href=https://confluence.atlassian.com/support/troubleshooting-and-support-tools-790796813.html>Atlassian Troubleshooting and Support Tools (ATST)</a> plugin. To disable either of the keys or the entire <code>ConfigMap</code>, set enabled to <code>false</code> in the following Helm values stanza:</p> <div class=highlight><pre><span></span><code><span class=nt>atlassianAnalyticsAndSupport</span><span class=p>:</span>
<span class=w>  </span><span class=nt>analytics</span><span class=p>:</span>
<span class=w>    </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class=w>  </span><span class=nt>helmValues</span><span class=p>:</span>
<span class=w>    </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div> <p>Helm values are mounted to be included to the <a class=external href=https://confluence.atlassian.com/support/create-a-support-zip-790796819.html>support.zip</a>. The values file is sanitized both on the Helm chart side (any <code>additionalEnvironmentVariables</code> and <code>additionalJvmArgs</code> that can potentially contain sensitive information are redacted) and ATST plugin that will redact hostnames, URLs, AWS ARNs and sensitive environment variables and JVM flags, if any. If the file is found at <code>/opt/atlassian/helm/values.yaml</code> you will see an option to include it to the support.zip when generating one in admin UI.</p> <p>Analytics json is a subset of <code>values.yaml</code> and contains selected Helm values that are sent as an analytics event and written to analytics logs, if analytics is enabled in the product. Analytics values are purely informational and contain information on how Helm charts are used.</p> <p>You can find the complete list of analytics values in <code>_helpers.tpl</code>, <code>&lt;product&gt;.analyticsJson</code>.</p> <h2 id=tunnels><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12v10h20V12c0-5.5-4.5-10-10-10M7.1 5.69A7.94 7.94 0 0 1 11 4.07v2.02c-.91.15-1.75.51-2.47 1.02zm8.37 1.42A5.95 5.95 0 0 0 13 6.09V4.07c1.46.18 2.79.76 3.9 1.62zM5.69 7.1l1.42 1.43A5.95 5.95 0 0 0 6.09 11H4.07c.18-1.46.76-2.79 1.62-3.9M6 13v2.5H4V13zm-2 7v-2.5h2V20zM16.89 8.53l1.42-1.43a7.94 7.94 0 0 1 1.62 3.9h-2.02a5.95 5.95 0 0 0-1.02-2.47M18 13h2v2.5h-2zm0 7v-2.5h2V20z"/></svg></span> Tunnels<a class=headerlink href=#tunnels title="Permanent link"> ¶</a></h2> <p>Jira and Confluence Helm charts support configuring tunnelling. To enable tunneling, set the following in your Helm values file: <div class=highlight><pre><span></span><code><span class=nt>jira</span><span class=p>:</span>
<span class=w>  </span><span class=nt>tunnel</span><span class=p>:</span>
<span class=w>    </span><span class=nt>additionalConnector</span><span class=p>:</span>
<span class=w>      </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">8093</span>
</code></pre></div></p> <p>An additional connector will be added to server.xml along with <code>Dsecure.tunnel.upstream.port</code> system property. If necessary, connector configuration can be overridden by setting <code>additionalConnector</code> properties to custom values:</p> <div class=highlight><pre><span></span><code><span class=nt>jira</span><span class=p>:</span>
<span class=w>  </span><span class=nt>tunnel</span><span class=p>:</span>
<span class=w>    </span><span class=nt>additionalConnector</span><span class=p>:</span>
<span class=w>      </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">8093</span>
<span class=w>      </span><span class=nt>connectionTimeout</span><span class=p>:</span><span class=w> </span><span class=s>&quot;200000&quot;</span>
<span class=w>      </span><span class=nt>maxThreads</span><span class=p>:</span><span class=w> </span><span class=s>&quot;100&quot;</span>
<span class=w>      </span><span class=nt>minSpareThreads</span><span class=p>:</span><span class=w> </span><span class=s>&quot;20&quot;</span>
<span class=w>      </span><span class=nt>enableLookups</span><span class=p>:</span><span class=w> </span><span class=s>&quot;true&quot;</span>
<span class=w>      </span><span class=nt>acceptCount</span><span class=p>:</span><span class=w> </span><span class=s>&quot;100&quot;</span>
<span class=w>      </span><span class=nt>URIEncoding</span><span class=p>:</span><span class=w> </span><span class=s>&quot;UTF-8&quot;</span>
<span class=w>      </span><span class=nt>secure</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</code></pre></div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; [2024] Atlassian and others. </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://community.atlassian.com/t5/Atlassian-Data-Center-on/gh-p/DC_Kubernetes target=_blank rel=noopener title=community.atlassian.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M152.2 236.4c-7.7-8.2-19.7-7.7-24.8 2.8L1.6 490.2c-5 10 2.4 21.7 13.4 21.7h175c5.8.1 11-3.2 13.4-8.4 37.9-77.8 15.1-196.3-51.2-267.1M244.4 8.1c-122.3 193.4-8.5 348.6 65 495.5 2.5 5.1 7.7 8.4 13.4 8.4H497c11.2 0 18.4-11.8 13.4-21.7 0 0-234.5-470.6-240.4-482.3-5.3-10.6-18.8-10.8-25.6.1"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["search.suggest", "search.highlight", "navigation.instant", "navigation.tabs", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.f55a23d4.min.js></script> </body> </html>