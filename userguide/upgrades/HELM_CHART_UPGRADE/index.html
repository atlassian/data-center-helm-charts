<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=../../monitoring/PRE_CANNED_CHARTS/ rel=prev><link href=../PRODUCTS_UPGRADE/ rel=next><link rel=icon href=../../../assets/logos/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.1"><title>Helm chart upgrade - Atlassian DC Helm Charts</title><link rel=stylesheet href=../../../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../assets/stylesheets/extra.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-FZ7HCVNVPY"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-FZ7HCVNVPY",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-FZ7HCVNVPY",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#helm-chart-upgrade class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <a href=https://community.atlassian.com/t5/Atlassian-Data-Center-on/gh-p/DC_Kubernetes title="Share your feedback with the Atlassian Data Center on Kubernetes Community" style=color:white><strong>Share your feedback and join the discussion</strong></a> </div> </aside> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title="Atlassian DC Helm Charts" class="md-header__button md-logo" aria-label="Atlassian DC Helm Charts" data-md-component=logo> <img src=../../../assets/logos/atlassian-logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Atlassian DC Helm Charts </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Helm chart upgrade </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/atlassian/data-center-helm-charts title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> atlassian/data-center-helm-charts </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../PREREQUISITES/ class=md-tabs__link> User guide </a> </li> <li class=md-tabs__item> <a href=../../../examples/EXAMPLES/ class=md-tabs__link> Examples </a> </li> <li class=md-tabs__item> <a href=../../../troubleshooting/TROUBLESHOOTING/ class=md-tabs__link> Troubleshooting </a> </li> <li class=md-tabs__item> <a href=../../../platforms/PLATFORMS/ class=md-tabs__link> Platforms </a> </li> <li class=md-tabs__item> <a href=../../../containers/JIRA/ class=md-tabs__link> Containers </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="Atlassian DC Helm Charts" class="md-nav__button md-logo" aria-label="Atlassian DC Helm Charts" data-md-component=logo> <img src=../../../assets/logos/atlassian-logo.svg alt=logo> </a> Atlassian DC Helm Charts </label> <div class=md-nav__source> <a href=https://github.com/atlassian/data-center-helm-charts title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> atlassian/data-center-helm-charts </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> User guide </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> User guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../PREREQUISITES/ class=md-nav__link> <span class=md-ellipsis> Prerequisites </span> </a> </li> <li class=md-nav__item> <a href=../../VERIFICATION/ class=md-nav__link> <span class=md-ellipsis> Verification </span> </a> </li> <li class=md-nav__item> <a href=../../INSTALLATION/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../../CONFIGURATION/ class=md-nav__link> <span class=md-ellipsis> Configuration </span> </a> </li> <li class=md-nav__item> <a href=../../MIGRATION/ class=md-nav__link> <span class=md-ellipsis> Migration </span> </a> </li> <li class=md-nav__item> <a href=../../OPERATION/ class=md-nav__link> <span class=md-ellipsis> Operation </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_7> <label class=md-nav__link for=__nav_2_7 id=__nav_2_7_label tabindex=0> <span class=md-ellipsis> Monitoring </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_7_label aria-expanded=false> <label class=md-nav__title for=__nav_2_7> <span class="md-nav__icon md-icon"></span> Monitoring </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../monitoring/PROMETHEUS/ class=md-nav__link> <span class=md-ellipsis> Prometheus and Grafana </span> </a> </li> <li class=md-nav__item> <a href=../../monitoring/PRE_CANNED_CHARTS/ class=md-nav__link> <span class=md-ellipsis> Product specific dashboards </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_8 checked> <label class=md-nav__link for=__nav_2_8 id=__nav_2_8_label tabindex=0> <span class=md-ellipsis> Upgrades </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_8_label aria-expanded=true> <label class=md-nav__title for=__nav_2_8> <span class="md-nav__icon md-icon"></span> Upgrades </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Helm chart upgrade </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Helm chart upgrade </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#1-find-the-current-version-of-the-installed-helm-chart class=md-nav__link> <span class=md-ellipsis> 1. Find the current version of the installed Helm chart </span> </a> </li> <li class=md-nav__item> <a href=#2-define-the-target-helm-chart-version class=md-nav__link> <span class=md-ellipsis> 2. Define the target Helm chart version </span> </a> </li> <li class=md-nav__item> <a href=#3-define-the-upgrade-method class=md-nav__link> <span class=md-ellipsis> 3. Define the upgrade method </span> </a> </li> <li class=md-nav__item> <a href=#4-get-the-current-helm-release-values class=md-nav__link> <span class=md-ellipsis> 4. Get the current Helm release values </span> </a> </li> <li class=md-nav__item> <a href=#5-upgrade-the-helm-chart class=md-nav__link> <span class=md-ellipsis> 5. Upgrade the Helm chart </span> </a> <nav class=md-nav aria-label="5. Upgrade the Helm chart"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#helm-chart-upgrade-with-downtime class=md-nav__link> <span class=md-ellipsis> Helm chart upgrade with downtime </span> </a> </li> <li class=md-nav__item> <a href=#helm-chart-upgrade-with-zero-downtime class=md-nav__link> <span class=md-ellipsis> Helm chart upgrade with zero downtime </span> </a> </li> <li class=md-nav__item> <a href=#helm-chart-upgrade-with-no-change-in-product-version class=md-nav__link> <span class=md-ellipsis> Helm chart upgrade with no change in product version </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../PRODUCTS_UPGRADE/ class=md-nav__link> <span class=md-ellipsis> Products upgrade </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_9> <label class=md-nav__link for=__nav_2_9 id=__nav_2_9_label tabindex=0> <span class=md-ellipsis> Resource management </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_9_label aria-expanded=false> <label class=md-nav__title for=__nav_2_9> <span class="md-nav__icon md-icon"></span> Resource management </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../resource_management/JIRA_INDEX_SNAPSHOT/ class=md-nav__link> <span class=md-ellipsis> Creating an initial index snapshot in Jira </span> </a> </li> <li class=md-nav__item> <a href=../../resource_management/REQUESTS_AND_LIMITS/ class=md-nav__link> <span class=md-ellipsis> Resource requests and limits </span> </a> </li> <li class=md-nav__item> <a href=../../resource_management/RESOURCE_SCALING/ class=md-nav__link> <span class=md-ellipsis> Product scaling </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Examples </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../examples/EXAMPLES/ class=md-nav__link> <span class=md-ellipsis> Available examples </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0> <span class=md-ellipsis> Kubernetes cluster </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Kubernetes cluster </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../examples/cluster/AKS_SETUP/ class=md-nav__link> <span class=md-ellipsis> Preparing an AKS cluster </span> </a> </li> <li class=md-nav__item> <a href=../../../examples/cluster/CLOUD_PROVIDERS/ class=md-nav__link> <span class=md-ellipsis> Provisioning Kubernetes clusters on cloud-based providers </span> </a> </li> <li class=md-nav__item> <a href=../../../examples/cluster/EKS_SETUP/ class=md-nav__link> <span class=md-ellipsis> Preparing an EKS cluster </span> </a> </li> <li class=md-nav__item> <a href=../../../examples/cluster/GKE_SETUP/ class=md-nav__link> <span class=md-ellipsis> Preparing an GKE cluster </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex=0> <span class=md-ellipsis> Database </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Database </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../examples/database/AMAZON_RDS/ class=md-nav__link> <span class=md-ellipsis> Creating an RDS database instance </span> </a> </li> <li class=md-nav__item> <a href=../../../examples/database/CLOUD_PROVIDERS/ class=md-nav__link> <span class=md-ellipsis> Provisioning databases on cloud-based providers </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4 id=__nav_3_4_label tabindex=0> <span class=md-ellipsis> Ingress </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Ingress </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../examples/ingress/CONTROLLERS/ class=md-nav__link> <span class=md-ellipsis> Provisioning an Ingress controller </span> </a> </li> <li class=md-nav__item> <a href=../../../examples/ingress/DNS/ class=md-nav__link> <span class=md-ellipsis> Create DNS record via AWS CLI </span> </a> </li> <li class=md-nav__item> <a href=../../../examples/ingress/INGRESS_NGINX/ class=md-nav__link> <span class=md-ellipsis> NGINX Ingress Controller - with TLS termination </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_5> <label class=md-nav__link for=__nav_3_5 id=__nav_3_5_label tabindex=0> <span class=md-ellipsis> Storage </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_5_label aria-expanded=false> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> Storage </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../examples/storage/STORAGE/ class=md-nav__link> <span class=md-ellipsis> Shared storage </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_5_2> <label class=md-nav__link for=__nav_3_5_2 id=__nav_3_5_2_label tabindex=0> <span class=md-ellipsis> AWS </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_5_2> <span class="md-nav__icon md-icon"></span> AWS </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../examples/storage/aws/LOCAL_STORAGE/ class=md-nav__link> <span class=md-ellipsis> Local storage </span> </a> </li> <li class=md-nav__item> <a href=../../../examples/storage/aws/SHARED_STORAGE/ class=md-nav__link> <span class=md-ellipsis> Shared storage </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_5_2_3> <label class=md-nav__link for=__nav_3_5_2_3 id=__nav_3_5_2_3_label tabindex=0> <span class=md-ellipsis> S3 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_3_5_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_5_2_3> <span class="md-nav__icon md-icon"></span> S3 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../examples/storage/aws/s3/CONFLUENCE/ class=md-nav__link> <span class=md-ellipsis> AWS S3 Attachments Storage </span> </a> </li> <li class=md-nav__item> <a href=../../../examples/storage/aws/s3/JIRA/ class=md-nav__link> <span class=md-ellipsis> AWS S3 Avatars Storage </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_5_3> <label class=md-nav__link for=__nav_3_5_3 id=__nav_3_5_3_label tabindex=0> <span class=md-ellipsis> NFS </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_5_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_5_3> <span class="md-nav__icon md-icon"></span> NFS </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../examples/storage/nfs/NFS/ class=md-nav__link> <span class=md-ellipsis> NFS server for Bitbucket </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_5_4> <label class=md-nav__link for=__nav_3_5_4 id=__nav_3_5_4_label tabindex=0> <span class=md-ellipsis> Additional Storage </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_5_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_5_4> <span class="md-nav__icon md-icon"></span> Additional Storage </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../examples/storage/additional%20storage/ADDTIONAL_STORAGE/ class=md-nav__link> <span class=md-ellipsis> Additional Storage </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_6> <label class=md-nav__link for=__nav_3_6 id=__nav_3_6_label tabindex=0> <span class=md-ellipsis> Bamboo </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_6_label aria-expanded=false> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> Bamboo </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../examples/bamboo/REMOTE_AGENTS/ class=md-nav__link> <span class=md-ellipsis> Remote agents </span> </a> </li> <li class=md-nav__item> <a href=../../../examples/bamboo/AGENT_CAPABILITIES/ class=md-nav__link> <span class=md-ellipsis> Agent capabilities </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_7> <label class=md-nav__link for=__nav_3_7 id=__nav_3_7_label tabindex=0> <span class=md-ellipsis> Bitbucket </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_7_label aria-expanded=false> <label class=md-nav__title for=__nav_3_7> <span class="md-nav__icon md-icon"></span> Bitbucket </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../examples/bitbucket/BITBUCKET_OPENSEARCH/ class=md-nav__link> <span class=md-ellipsis> OpenSearch </span> </a> </li> <li class=md-nav__item> <a href=../../../examples/bitbucket/BITBUCKET_ELASTICSEARCH/ class=md-nav__link> <span class=md-ellipsis> Elasticsearch (Deprecated) </span> </a> </li> <li class=md-nav__item> <a href=../../../examples/bitbucket/BITBUCKET_MIRRORS/ class=md-nav__link> <span class=md-ellipsis> Smart Mirrors </span> </a> </li> <li class=md-nav__item> <a href=../../../examples/bitbucket/BITBUCKET_SSH/ class=md-nav__link> <span class=md-ellipsis> SSH </span> </a> </li> <li class=md-nav__item> <a href=../../../examples/bitbucket/BITBUCKET_MESH/ class=md-nav__link> <span class=md-ellipsis> Mesh </span> </a> </li> <li class=md-nav__item> <a href=../../../examples/bitbucket/BITBUCKET_AWS_OPENSEARCH/ class=md-nav__link> <span class=md-ellipsis> Configure AWS OpenSearch with Bitbucket </span> </a> </li> <li class=md-nav__item> <a href=../../../examples/bitbucket/BITBUCKET_SESSION_AFFINITY/ class=md-nav__link> <span class=md-ellipsis> Configure Session Stickiness with NGINX Ingress </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_8> <label class=md-nav__link for=__nav_3_8 id=__nav_3_8_label tabindex=0> <span class=md-ellipsis> Confluence </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_8_label aria-expanded=false> <label class=md-nav__title for=__nav_3_8> <span class="md-nav__icon md-icon"></span> Confluence </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../examples/confluence/CONFLUENCE_OPENSEARCH/ class=md-nav__link> <span class=md-ellipsis> Configuring OpenSearch for Confluence </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../examples/logging/efk/EFK/ class=md-nav__link> <span class=md-ellipsis> Logging in a Kubernetes environment </span> </a> </li> <li class=md-nav__item> <a href=../../../examples/external_libraries/EXTERNAL_LIBS/ class=md-nav__link> <span class=md-ellipsis> External libraries and plugins </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Troubleshooting </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Troubleshooting </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../troubleshooting/TROUBLESHOOTING/ class=md-nav__link> <span class=md-ellipsis> Troubleshooting tips </span> </a> </li> <li class=md-nav__item> <a href=../../../troubleshooting/SUPPORT_BOUNDARIES/ class=md-nav__link> <span class=md-ellipsis> Support boundaries </span> </a> </li> <li class=md-nav__item> <a href=../../../troubleshooting/LIMITATIONS/ class=md-nav__link> <span class=md-ellipsis> Limitations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Platforms </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Platforms </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../platforms/PLATFORMS/ class=md-nav__link> <span class=md-ellipsis> Platform information </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_2> <label class=md-nav__link for=__nav_5_2 id=__nav_5_2_label tabindex=0> <span class=md-ellipsis> Openshift </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> Openshift </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../platforms/openshift/OPENSHIFT/ class=md-nav__link> <span class=md-ellipsis> Deploy To OpenShift </span> </a> </li> <li class=md-nav__item> <a href=../../../platforms/openshift/OPENSHIFT_FAQ/ class=md-nav__link> <span class=md-ellipsis> OpenShift FAQs </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Containers </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Containers </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../containers/JIRA/ class=md-nav__link> <span class=md-ellipsis> Jira </span> </a> </li> <li class=md-nav__item> <a href=../../../containers/CONFLUENCE/ class=md-nav__link> <span class=md-ellipsis> Confluence </span> </a> </li> <li class=md-nav__item> <a href=../../../containers/BITBUCKET/ class=md-nav__link> <span class=md-ellipsis> Bitbucket </span> </a> </li> <li class=md-nav__item> <a href=../../../containers/BITBUCKET-MESH/ class=md-nav__link> <span class=md-ellipsis> Bitbucket Mesh </span> </a> </li> <li class=md-nav__item> <a href=../../../containers/BAMBOO-AGENT/ class=md-nav__link> <span class=md-ellipsis> Bamboo Agent </span> </a> </li> <li class=md-nav__item> <a href=../../../containers/BAMBOO/ class=md-nav__link> <span class=md-ellipsis> Bamboo </span> </a> </li> <li class=md-nav__item> <a href=../../../containers/CROWD/ class=md-nav__link> <span class=md-ellipsis> Crowd </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#1-find-the-current-version-of-the-installed-helm-chart class=md-nav__link> <span class=md-ellipsis> 1. Find the current version of the installed Helm chart </span> </a> </li> <li class=md-nav__item> <a href=#2-define-the-target-helm-chart-version class=md-nav__link> <span class=md-ellipsis> 2. Define the target Helm chart version </span> </a> </li> <li class=md-nav__item> <a href=#3-define-the-upgrade-method class=md-nav__link> <span class=md-ellipsis> 3. Define the upgrade method </span> </a> </li> <li class=md-nav__item> <a href=#4-get-the-current-helm-release-values class=md-nav__link> <span class=md-ellipsis> 4. Get the current Helm release values </span> </a> </li> <li class=md-nav__item> <a href=#5-upgrade-the-helm-chart class=md-nav__link> <span class=md-ellipsis> 5. Upgrade the Helm chart </span> </a> <nav class=md-nav aria-label="5. Upgrade the Helm chart"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#helm-chart-upgrade-with-downtime class=md-nav__link> <span class=md-ellipsis> Helm chart upgrade with downtime </span> </a> </li> <li class=md-nav__item> <a href=#helm-chart-upgrade-with-zero-downtime class=md-nav__link> <span class=md-ellipsis> Helm chart upgrade with zero downtime </span> </a> </li> <li class=md-nav__item> <a href=#helm-chart-upgrade-with-no-change-in-product-version class=md-nav__link> <span class=md-ellipsis> Helm chart upgrade with no change in product version </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=helm-chart-upgrade>Helm chart upgrade<a class=headerlink href=#helm-chart-upgrade title="Permanent link"> ¶</a></h1> <p>Each Helm chart has a default product version that might change in next Helm chart version. So be aware that if you upgrade the Helm chart, it might lead to upgrading the product as well. This depends on the current and target Helm chart versions. </p> <div class="admonition important"> <p class=admonition-title>Do you want to upgrade the product to a new version?</p> <p>If you want to upgrade the product version without upgrading the Helm chart then refer to <a href=../PRODUCTS_UPGRADE/ >Product upgrades</a>. </p> </div> <p>Before upgrading the Helm chart, first consider: </p> <ul> <li>the version of the current Helm chart</li> <li>the version of the product running on your Kubernetes cluster</li> <li>the target version of the Helm chart you want to upgrade to</li> <li>the target version of the product you want to upgrade to</li> </ul> <p>You need to know if the target product version is zero-downtime compatible (if it is subject to change). Based on this information you may need to choose a different upgrade method.</p> <div class="admonition info"> <p class=admonition-title>Upgrade product strategies</p> <p>There are two options for upgrade:</p> <ul> <li><em>Normal upgrade</em>: The service will have interruptions during the upgrade.</li> <li><em>Rolling upgrade</em>: The upgrade will proceed with zero downtime.</li> </ul> </div> <h2 id=1-find-the-current-version-of-the-installed-helm-chart>1. Find the current version of the installed Helm chart<a class=headerlink href=#1-find-the-current-version-of-the-installed-helm-chart title="Permanent link"> ¶</a></h2> <p>To find the current version of Helm chart and the product version run the following command:</p> <div class=highlight><pre><span></span><code>helm<span class=w> </span>list<span class=w> </span>--namespace<span class=w> </span>&lt;namespace&gt;<span class=w> </span>
</code></pre></div> <p>You can see the current Helm chart tag version in the <code>CHART</code> column, and the current product tag version in the <code>APP VERSION</code> column for each release name. </p> <h2 id=2-define-the-target-helm-chart-version>2. Define the target Helm chart version<a class=headerlink href=#2-define-the-target-helm-chart-version title="Permanent link"> ¶</a></h2> <div class="admonition hint"> <p class=admonition-title>Do you have the Atlassian Helm chart repository locally?</p> <p>Make sure you have the Atlassian Helm chart repository in your local Helm repositories. Run the following command to add them:</p> <div class=highlight><pre><span></span><code>helm<span class=w> </span>repo<span class=w> </span>add<span class=w> </span>atlassian-data-center<span class=w> </span><span class=se>\</span>
<span class=w>     </span>https://atlassian.github.io/data-center-helm-charts
</code></pre></div> </div> <p>Update the Helm chart repository on your local Helm installation:</p> <div class=highlight><pre><span></span><code>helm<span class=w> </span>repo<span class=w> </span>update
</code></pre></div> <div class="admonition warning"> <p class=admonition-title>Target Helm chart version</p> <p>The target Helm chart version must be higher than the current Helm chart version.</p> </div> <p>To see all available Helm chart versions of the specific product run this command:</p> <div class=highlight><pre><span></span><code>helm<span class=w> </span>search<span class=w> </span>repo<span class=w> </span>atlassian-data-center/&lt;product&gt;<span class=w> </span>--versions
</code></pre></div> <p>Select the target Helm chart version. You can find the default application version (target product version tag) in the <code>APP VERSION</code> column.</p> <div class="admonition error"> <p class=admonition-title>Upgrading the Helm chart to a MAJOR version is not backward compatible.</p> <p>The Helm chart is <a href=https://semver.org/ class=external>semantically versioned</a>. You need to take some extra steps if you are upgrading the Helm chart to a MAJOR version. Before you proceed, learn about the steps for your target version in the <a href=../../../#upgrading>upgrading section</a>. </p> </div> <h2 id=3-define-the-upgrade-method>3. Define the upgrade method<a class=headerlink href=#3-define-the-upgrade-method title="Permanent link"> ¶</a></h2> <p>Considering the current and target <strong>product</strong> versions there are different scenarios: </p> <ol> <li>The versions are different, and the target product version is not zero-downtime compatible. </li> <li>The versions are different, and the target product version is zero-downtime compatible. </li> <li>The versions are the same.</li> </ol> <div class="admonition important"> <p class=admonition-title>See the following links to find out if two versions of a product are zero-downtime compatible</p> <ul> <li>Jira: <a class=external href=https://confluence.atlassian.com/adminjiraserver/upgrading-jira-data-center-with-zero-downtime-938846953.html>Upgrading Jira with zero downtime</a> </li> <li>Confluence: <a class=external href=https://confluence.atlassian.com/doc/upgrade-confluence-without-downtime-1027127923.html>Upgrading Confluence with zero downtime</a> </li> <li>Bitbucket: <a class=external href=https://confluence.atlassian.com/bitbucketserver/upgrade-bitbucket-without-downtime-1038780379.html>Upgrading Bitbucket with zero downtime</a></li> <li>Bamboo: Zero downtime upgrades for Bamboo server and Bamboo agents are currently not supported.</li> <li>Crowd: Zero downtime upgrades for Crowd are currently not supported.</li> </ul> </div> <div class="admonition note"> <p class=admonition-title>All supported Jira versions are zero-downtime compatible</p> <p>The minimum supported version of Jira in the Data Center Helm Charts is <code>8.19</code>. Considering any Jira version later than 8.x is zero-downtime compatible, all supported Jira Data Center versions are zero-downtime compatible. </p> </div> <p>Based on the scenario follow one of these options in the next step:</p> <ul> <li><strong>Normal upgrade</strong>: Upgrade Helm chart when the target product version is not zero-downtime compatible, or you want to avoid mixed version during the upgrade. In this option the product will have a downtime during the upgrade process. </li> <li><strong>Rolling upgrade</strong>: Upgrade Helm chart when the target product version is zero-downtime compatible. This option will only apply when the target product version is zero-downtime compatible. If you are not sure about this see the links above. </li> <li><strong>No product upgrade</strong>: Upgrade the Helm chart with no change in product version. We recommend this method when the target product version is the same as the current product version, or for any other reason you may not want to change the product version but still upgrade the helm chart. </li> </ul> <h2 id=4-get-the-current-helm-release-values>4. Get the current Helm release values<a class=headerlink href=#4-get-the-current-helm-release-values title="Permanent link"> ¶</a></h2> <div class="admonition warning"> <p class=admonition-title>--reuse-values argument</p> <p>Do not pass <code>--reuse-values</code> to <code>helm upgrade</code> command because the default values in the new Helm chart version will be ignored which can result in templating errors and upgrade failures.</p> </div> <p>If you have not saved the original values file used during the initial Helm chart installation, you can retrieve user-supplied values:</p> <div class=highlight><pre><span></span><code>helm<span class=w> </span>get<span class=w> </span>values<span class=w> </span>&lt;release-name&gt;<span class=w> </span>-n<span class=w> </span>&lt;namespace&gt;<span class=w> </span>-o<span class=w> </span>yaml<span class=w> </span>&gt;<span class=w> </span>values.yaml
</code></pre></div> <p>Use this file in the argument to <code>helm upgrade</code> command, for example:</p> <div class=highlight><pre><span></span><code>-f<span class=w> </span>/home/user/values.yaml
</code></pre></div> <h2 id=5-upgrade-the-helm-chart>5. Upgrade the Helm chart<a class=headerlink href=#5-upgrade-the-helm-chart title="Permanent link"> ¶</a></h2> <div class="admonition hint"> <p class=admonition-title>Tip: Monitor the pods during the upgrade process</p> <p>You can monitor the pod activities during the upgrade by running the following command in a separate terminal: <div class=highlight><pre><span></span><code>kubectl<span class=w> </span>get<span class=w> </span>pods<span class=w> </span>--namespace<span class=w> </span>&lt;namespace&gt;<span class=w> </span>--watch
</code></pre></div></p> </div> <div class="tabbed-set tabbed-alternate" data-tabs=1:3><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><input id=__tabbed_1_3 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>Normal upgrade</label><label for=__tabbed_1_2>Rolling upgrade</label><label for=__tabbed_1_3>Upgrade with no change in the product version</label></div> <div class=tabbed-content> <div class=tabbed-block> <h3 id=helm-chart-upgrade-with-downtime>Helm chart upgrade with downtime<a class=headerlink href=#helm-chart-upgrade-with-downtime title="Permanent link"> ¶</a></h3> <p>You need to use this method to upgrade the Helm chart if:</p> <ul> <li>the target product version is not zero downtime-compatible</li> <li>for any other reason you would prefer to avoid running the cluster in mix mode</li> </ul> <div class="admonition warning"> <p class=admonition-title>Upgrading the Helm chart might change the product version</p> <p>If you want to upgrade the Helm chart to a newer version but don't want to change the product version then follow the <em>Upgrade with no change in product version</em> tab.</p> </div> <p>The strategy for upgrading the product with downtime is to scale down the cluster to zero nodes and then start the nodes with new product versions. And finally scale the cluster up to the original number of nodes. Here are step-by-step instructions for the upgrade process:</p> <ol> <li>Find out the number of nodes in the cluster. <div class=highlight><pre><span></span><code>kubectl<span class=w> </span>describe<span class=w> </span>sts<span class=w> </span>&lt;release-name&gt;<span class=w> </span>--namespace<span class=w> </span>&lt;namespace&gt;<span class=w> </span><span class=p>|</span><span class=w> </span>grep<span class=w> </span><span class=s1>&#39;Replicas&#39;</span>
</code></pre></div></li> <li> <p>Upgrade the Helm chart.<br> Replace the product name in the following command: <div class=highlight><pre><span></span><code>helm<span class=w> </span>upgrade<span class=w> </span>&lt;release-name&gt;<span class=w> </span>atlassian-data-center/&lt;product&gt;<span class=w> </span><span class=se>\</span>
<span class=w> </span>--version<span class=w> </span>&lt;target-helm-chart-version&gt;<span class=w> </span><span class=se>\</span>
<span class=w> </span>-f<span class=w> </span>&lt;path-to-values-yaml&gt;<span class=w> </span><span class=se>\</span>
<span class=w> </span>--set<span class=w> </span><span class=nv>replicaCount</span><span class=o>=</span><span class=m>1</span><span class=w> </span><span class=se>\</span>
<span class=w> </span>--wait<span class=w> </span><span class=se>\</span>
<span class=w> </span>--namespace<span class=w> </span>&lt;namespace&gt;
</code></pre></div> The cluster will scale down to zero nodes. Then one pod with the target product version will be recreated and join the cluster. </p> </li> <li> <p>Scale up the cluster. After you confirm the new pod is in <code>Running</code> status then scale up the cluster to the same number of nodes as before the upgrade: <div class=highlight><pre><span></span><code>helm<span class=w> </span>upgrade<span class=w> </span>&lt;release-name&gt;<span class=w> </span>atlassian-data-center/confluence<span class=w> </span><span class=se>\</span>
<span class=w> </span>-f<span class=w> </span>&lt;path-to-values-yaml&gt;<span class=w> </span><span class=se>\</span>
<span class=w> </span>--set<span class=w> </span><span class=nv>replicaCount</span><span class=o>=</span>&lt;n&gt;<span class=w> </span><span class=se>\</span>
<span class=w> </span>--wait<span class=w> </span><span class=se>\</span>
<span class=w> </span>--namespace<span class=w> </span>&lt;namespace&gt;
</code></pre></div></p> </li> </ol> </div> <div class=tabbed-block> <h3 id=helm-chart-upgrade-with-zero-downtime>Helm chart upgrade with zero downtime<a class=headerlink href=#helm-chart-upgrade-with-zero-downtime title="Permanent link"> ¶</a></h3> <div class="admonition warning"> <p class=admonition-title>Upgrade the Helm chart might change the product version</p> <p>If you want to upgrade the Helm chart to newer version but don't want to change the product version then follow the <em>Upgrade with no change in product version</em> tab.</p> </div> <div class="admonition warning"> <p class=admonition-title>Rolling upgrade is not possible if the cluster has only one node</p> <p>If you have just one node in the cluster then you can't take advantage of the zero-downtime approach. You may scale up the cluster to at least two nodes before upgrading or there will be a downtime during the upgrade. </p> </div> <p>In order to upgrade the Helm chart when the target product version is different from the current product version, you can use upgrade with zero downtime to avoid any service interruption during the upgrade. To use this option the target version must be zero-downtime compatible. </p> <div class="admonition important"> <p class=admonition-title>Make sure the product target version is zero downtime-compatible</p> <p>To ensure you will have a smooth upgrade make sure the product target version is zero-downtime compatible. If you still aren't sure about this go back to step 3. </p> </div> <p>Here are the step-by-step instructions of the upgrade process. These steps may vary for each product:</p> <div class="tabbed-set tabbed-alternate" data-tabs=2:5><input checked=checked id=__tabbed_2_1 name=__tabbed_2 type=radio><input id=__tabbed_2_2 name=__tabbed_2 type=radio><input id=__tabbed_2_3 name=__tabbed_2 type=radio><input id=__tabbed_2_4 name=__tabbed_2 type=radio><input id=__tabbed_2_5 name=__tabbed_2 type=radio><div class=tabbed-labels><label for=__tabbed_2_1>Jira</label><label for=__tabbed_2_2>Confluence</label><label for=__tabbed_2_3>Bitbucket</label><label for=__tabbed_2_4>Bamboo</label><label for=__tabbed_2_5>Crowd</label></div> <div class=tabbed-content> <div class=tabbed-block> <ol> <li> <p>Put Jira into upgrade mode. Go to <strong>Administration &gt; Applications &gt; Jira upgrades</strong> and click <strong>Put Jira into upgrade mode</strong>. <img alt=upgrade-mode src=../../../assets/images/jira-upgrade-1.png></p> </li> <li> <p>Run the upgrade using Helm. </p> <div class=highlight><pre><span></span><code>helm<span class=w> </span>upgrade<span class=w> </span>&lt;release-name&gt;<span class=w> </span>atlassian-data-center/jira<span class=w> </span><span class=se>\</span>
<span class=w> </span>--version<span class=w> </span>&lt;target-helm-chart-version&gt;<span class=w> </span><span class=se>\</span>
<span class=w> </span>-f<span class=w> </span>&lt;path-to-values-yaml&gt;<span class=w> </span><span class=se>\</span>
<span class=w> </span>--wait<span class=w> </span><span class=se>\</span>
<span class=w> </span>--namespace<span class=w> </span>&lt;namespace&gt;
</code></pre></div> </li> <li> <p>Wait for the upgrade to finish. The pods will be recreated with the updated version, one at a time.</p> <p><img alt=upgrade-mode src=../../../assets/images/jira-upgrade-2.png></p> </li> <li> <p>Finalize the upgrade. After all the pods are active with the new version, click <strong>Run upgrade tasks</strong> to finalize the upgrade:</p> <p><img alt=upgrade-mode src=../../../assets/images/jira-upgrade-3.png></p> </li> </ol> </div> <div class=tabbed-block> <ol> <li> <p>Put Confluence into upgrade mode. From the admin page click on <em>Rolling Upgrade</em> and set the Confluence in Upgrade mode:</p> <p><img alt=upgrade-mode src=../../../assets/images/confluence-upgrade-1.png></p> </li> <li> <p>Run the upgrade using Helm. <div class=highlight><pre><span></span><code>helm<span class=w> </span>upgrade<span class=w> </span>&lt;release-name&gt;<span class=w> </span>atlassian-data-center/confluence<span class=w> </span><span class=se>\</span>
<span class=w>    </span>--version<span class=w> </span>&lt;target-helm-chart-version&gt;<span class=w> </span><span class=se>\</span>
<span class=w>    </span>-f<span class=w> </span>&lt;path-to-values-yaml&gt;<span class=w> </span><span class=se>\</span>
<span class=w>    </span>--wait<span class=w> </span><span class=se>\</span>
<span class=w>    </span>--namespace<span class=w> </span>&lt;namespace&gt;
</code></pre></div> Wait until all pods are recreated and are back to <code>Running</code> status. </p> </li> <li> <p>Wait for the upgrade to finish. The pods will be recreated with the updated version, one at a time.</p> <p><img alt=upgrade-mode src=../../../assets/images/confluence-upgrade-2.png></p> </li> <li> <p>Finalize the upgrade. After all the pods are active with the new version, click <strong>Run upgrade tasks</strong> to finalize the upgrade:</p> <p><img alt=upgrade-mode src=../../../assets/images/confluence-upgrade-3.png></p> </li> </ol> </div> <div class=tabbed-block> <ol> <li> <p>Put Bitbucket into upgrade mode. From the admin page click on <em>Rolling Upgrade</em> and set the Bitbucket in Upgrade mode:</p> <p><img alt=upgrade-mode src=../../../assets/images/bitbucket-upgrade-1.png></p> </li> <li> <p>Run the upgrade using Helm. </p> <p><div class=highlight><pre><span></span><code>helm<span class=w> </span>upgrade<span class=w> </span>&lt;release-name&gt;<span class=w> </span>atlassian-data-center/bitbucket<span class=w> </span><span class=se>\</span>
<span class=w> </span>--version<span class=w> </span>&lt;target-helm-chart-version&gt;<span class=w> </span><span class=se>\</span>
<span class=w> </span>-f<span class=w> </span>&lt;path-to-values-yaml&gt;<span class=w> </span><span class=se>\</span>
<span class=w> </span>--wait<span class=w> </span><span class=se>\</span>
<span class=w> </span>--namespace<span class=w> </span>&lt;namespace&gt;
</code></pre></div> Wait until all pods are recreated and are back to <code>Running</code> status. </p> </li> <li> <p>Wait for the upgrade to finish. The pods will be recreated with the updated version, one at a time.</p> <p><img alt=upgrade-mode src=../../../assets/images/bitbucket-upgrade-2.png></p> </li> <li> <p>Finalize the upgrade. After all the pods are active with the new version, click <strong>Run upgrade tasks</strong> to finalize the upgrade:</p> <p><img alt=upgrade-mode src=../../../assets/images/bitbucket-upgrade-3.png></p> </li> </ol> </div> <div class=tabbed-block> <div class="admonition warning"> <p class=admonition-title>Bamboo and zero downtime upgrades</p> <p>Zero downtime upgrades for Bamboo server and Bamboo agents are currently not supported.</p> </div> </div> <div class=tabbed-block> <div class="admonition warning"> <p class=admonition-title>Crowd and zero downtime upgrades</p> <p>Zero downtime upgrades for Crowd are currently not supported.</p> </div> </div> </div> </div> </div> <div class=tabbed-block> <h3 id=helm-chart-upgrade-with-no-change-in-product-version>Helm chart upgrade with no change in product version<a class=headerlink href=#helm-chart-upgrade-with-no-change-in-product-version title="Permanent link"> ¶</a></h3> <p>If your target Helm chart has a different product version in comparison with the current product version, and you still want to keep the current product version unchanged, you should use the following command to upgrade the Helm chart:</p> <div class=highlight><pre><span></span><code>helm<span class=w> </span>upgrade<span class=w> </span>&lt;release-name&gt;<span class=w> </span>atlassian-data-center/&lt;product&gt;<span class=w> </span><span class=se>\</span>
<span class=w>    </span>--version<span class=w> </span>&lt;helm-chart-target-version&gt;<span class=w> </span><span class=se>\</span>
<span class=w>    </span>-f<span class=w> </span>&lt;path-to-values-yaml&gt;<span class=w> </span><span class=se>\</span>
<span class=w>    </span>--set<span class=w> </span>image.tag<span class=o>=</span>&lt;current-product-tag&gt;<span class=w> </span><span class=se>\</span>
<span class=w>    </span>--wait<span class=w> </span><span class=se>\</span>
<span class=w>    </span>--namespace<span class=w> </span>&lt;namespace&gt;
</code></pre></div> <p>However, when the product versions of target and current Helm charts are the same, then you can run the following command to upgrade the Helm chart only:</p> <div class=highlight><pre><span></span><code>helm<span class=w> </span>upgrade<span class=w> </span>&lt;release-name&gt;<span class=w> </span>atlassian-data-center/&lt;product&gt;<span class=w> </span><span class=se>\</span>
<span class=w>     </span>--version<span class=w> </span>&lt;helm-chart-target-version&gt;<span class=w> </span><span class=se>\</span>
<span class=w>     </span>-f<span class=w> </span>&lt;path-to-values-yaml&gt;<span class=w> </span><span class=se>\</span>
<span class=w>     </span>--wait<span class=w> </span><span class=se>\</span>
<span class=w>     </span>--namespace<span class=w> </span>&lt;namespace&gt;
</code></pre></div> </div> </div> </div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; [2024] Atlassian and others. </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://community.atlassian.com/t5/Atlassian-Data-Center-on/gh-p/DC_Kubernetes target=_blank rel=noopener title=community.atlassian.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M152.2 236.4c-7.7-8.2-19.7-7.7-24.8 2.8L1.6 490.2c-5 10 2.4 21.7 13.4 21.7h175c5.8.1 11-3.2 13.4-8.4 37.9-77.8 15.1-196.3-51.2-267.1M244.4 8.1c-122.3 193.4-8.5 348.6 65 495.5 2.5 5.1 7.7 8.4 13.4 8.4H497c11.2 0 18.4-11.8 13.4-21.7 0 0-234.5-470.6-240.4-482.3-5.3-10.6-18.8-10.8-25.6.1"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "../../..", "features": ["search.suggest", "search.highlight", "navigation.instant", "navigation.tabs", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../../assets/javascripts/bundle.79ae519e.min.js></script> </body> </html>